#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
    FITNESS TIMER Автопостинг
    
    Автоматическая генерация и публикация табата-тренировок
    в Telegram канал FITNESS TIMER через DeepSeek AI
    
    Автор: VR-Lounge
    Канал: @fitnesstimer
"""

import os
import requests
import json
import random
from datetime import datetime

# ============= КОНФИГУРАЦИЯ =============

# Получаем токены из переменных окружения (для безопасности)
ДИПСИК_АПИ_КЛЮЧ = os.getenv('DEEPSEEK_API_KEY', '')
ТЕЛЕГРАМ_БОТ_ТОКЕН = os.getenv('TELEGRAM_BOT_TOKEN', '')
ТЕЛЕГРАМ_ЧАТ_ID = os.getenv('TELEGRAM_CHAT_ID', '')

# Список URL фитнес-изображений с Unsplash
ФИТНЕС_ИЗОБРАЖЕНИЯ = [
    "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?w=800",
    "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=800",
    "https://images.unsplash.com/photo-1541534741688-6078c6bfb5c5?w=800",
    "https://images.unsplash.com/photo-1434682772747-f16d3ea162c3?w=800",
    "https://images.unsplash.com/photo-1518310383802-640c2de311b2?w=800",
    "https://images.unsplash.com/photo-1574680096145-d05b474e2155?w=800",
    "https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?w=800",
    "https://images.unsplash.com/photo-1605296867304-46d5465a13f1?w=800",
    "https://images.unsplash.com/photo-1623874514711-0f321325f318?w=800",
    "https://images.unsplash.com/photo-1583454110551-21f2fa2afe61?w=800",
]

# Прямые URL изображений для рецептов (не требуют API ключа)
# Важно: Telegram хуже работает с редиректами (например, source.unsplash.com),
# поэтому используем прямые ссылки images.unsplash.com/photo-... ?w=800
ФОТО_РЕЦЕПТОВ = {
    "Омлет с шпинатом и томатами": "https://images.unsplash.com/photo-1668283653825-37b80f055b05?w=800",
    "Гречка с куриной грудкой": "https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=800",
    "Творожная запеканка с ягодами": "https://images.unsplash.com/photo-1610858630667-4b658633a527?w=800",
    "Овсянка с бананом и орехами": "https://images.unsplash.com/photo-1584970922591-5b91e5f927a9?w=800",
    "Куриные котлеты на пару с брокколи": "https://images.unsplash.com/photo-1670398564097-0762e1b30b3a?w=800",
    "Рыбные стейки с киноа": "https://images.unsplash.com/photo-1623428187969-5da2dcea5ebf?w=800",
    "Белковый смузи": "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=800",
    "Салат с тунцом и авокадо": "https://images.unsplash.com/photo-1604909052743-94e838986d24?w=800",
    "Фриттата с овощами": "https://images.unsplash.com/photo-1510693206972-df098062cb71?w=800",
    "Куриная грудка с бататом": "https://images.unsplash.com/photo-1547592180-85f173990554?w=800",
    "Творог с мёдом и орехами": "https://images.unsplash.com/photo-1677844592730-ce9c936d8f1a?w=800",
    "Рис с индейкой и овощами": "https://images.unsplash.com/photo-1571748982800-fa51082c2224?w=800",
    "Чечевичный суп": "https://images.unsplash.com/photo-1591266798549-32fa7cd32f45?w=800",
    "Сырники без муки": "https://images.unsplash.com/photo-1528207776546-365bb710ee93?w=800",
    "Тёплый салат с курицей": "https://images.unsplash.com/photo-1622756144420-6877b1b7476e?w=800",
    "Запечённая рыба с овощами": "https://images.unsplash.com/photo-1552298013-de2af4b94854?w=800",
    "Протеиновые панкейки": "https://images.unsplash.com/photo-1612182062633-9ff3b3598e96?w=800",
    "Боул с киноа и курицей": "https://images.unsplash.com/photo-1615865417491-9941019fbc00?w=800",
    "Греческий йогурт с ягодами": "https://images.unsplash.com/photo-1618798513386-fedeb5c30d39?w=800",
    "Омлет-рулет с семгой": "https://images.unsplash.com/photo-1668665771867-7b3b53d7597a?w=800",
}

# Темы для разнообразного контента (с болями и желаниями)
ТЕМЫ_КОНТЕНТА = [
    {
        "тип": "тренировка",
        "тема": "Табата для занятых",
        "боли": "Нет времени на зал, устаешь после работы, не хватает энергии",
        "желания": "Быстро, дома, без оборудования, за 4 минуты",
        "результат": "Бодрость, подтянутое тело, уверенность в себе"
    },
    {
        "тип": "тренировка",
        "тема": "HIIT против стресса",
        "боли": "Постоянный стресс, нервное напряжение, плохой сон",
        "желания": "Сбросить напряжение, выплеснуть эмоции, расслабиться",
        "результат": "Спокойствие, крепкий сон, хорошее настроение"
    },
    {
        "тип": "тренировка",
        "тема": "Питание без диет",
        "боли": "Надоели срывы, чувство голода, запретные продукты",
        "желания": "Есть любимое, не считать калории, без стресса",
        "результат": "Стройное тело, энергия, свобода от диет"
    },
    {
        "тип": "тренировка",
        "тема": "Восстановление после тренировки",
        "боли": "Болят мышцы, нет сил, долго восстанавливаешься",
        "желания": "Быстро восстановиться, чувствовать легкость, не бояться нагрузок",
        "результат": "Быстрое восстановление, больше тренировок, лучшие результаты"
    },
    {
        "тип": "тренировка",
        "тема": "Мотивация продолжать",
        "боли": "Пропадает запал, лень, не видишь результатов",
        "желания": "Чувствовать драйв, видеть прогресс, кайфовать от процесса",
        "результат": "Постоянство, видимый прогресс, гордость собой"
    },
    {
        "тип": "тренировка",
        "тема": "Тренировка для уверенности",
        "боли": "Низкая самооценка, стесняешься тела, нет уверенности",
        "желания": "Чувствовать себя сильной/сильным, нравиться себе в зеркале",
        "результат": "Уверенность, комплименты окружающих, внимание"
    },
    # =================== РЕЦЕПТЫ (20 шт) ===================
    {
        "тема": "Омлет с шпинатом и томатами",
        "тип": "рецепт",
        "категория": "Завтрак",
        "время": "7 минут",
        "продукты": [
            "Яйца (2 шт.) — 20 руб.",
            "Шпинат замороженный (50 г) — 15 руб.",
            "Томат (1 шт.) — 10 руб.",
            "Молоко (30 мл) — 3 руб.",
            "Соль/перец — 2 руб."
        ],
        "итого": "~50 рублей",
        "способ": [
            "Разморозь шпинат, слегка отожми лишнюю влагу.",
            "Взбей яйца с молоком, солью и перцем.",
            "На сковороде прогрей шпинат 30–40 секунд, добавь нарезанный томат.",
            "Залей яйцами и готовь под крышкой 3–4 минуты на среднем огне."
        ],
        "нутриенты": "Калории: 260 ккал | Белки: 18 г | Жиры: 18 г | Углеводы: 8 г",
        "польза": "Белковый завтрак помогает лучше контролировать аппетит и поддерживать мышечный белковый синтез; см. обзор по высокобелковым завтракам (American Journal of Clinical Nutrition, 2015).",
        "лайфхак": "Если нет шпината — возьми замороженную стручковую фасоль: тоже быстро и бюджетно.",
        "фото_запрос": "spinach omelette tomatoes"
    },
    {
        "тема": "Гречка с куриной грудкой",
        "тип": "рецепт",
        "категория": "Обед",
        "время": "25 минут",
        "продукты": [
            "Гречка (80 г сухой) — 10 руб.",
            "Куриная грудка (150 г) — 40 руб.",
            "Лук (1/2 шт.) — 5 руб.",
            "Морковь (1/2 шт.) — 5 руб.",
            "Растительное масло (1 ч. л.) — 5 руб."
        ],
        "итого": "~65 рублей",
        "способ": [
            "Промой гречку и поставь вариться (примерно 15 минут).",
            "Курицу нарежь кубиком, быстро обжарь на капле масла 3–4 минуты.",
            "Добавь лук и морковь, туши ещё 6–7 минут.",
            "Смешай с готовой гречкой, посоли, добавь специи по вкусу."
        ],
        "нутриенты": "Калории: 520 ккал | Белки: 38 г | Жиры: 14 г | Углеводы: 60 г",
        "польза": "Комбинация крупы и постного белка улучшает сытость и помогает закрывать суточную норму белка; см. обзоры о влиянии белка на насыщение (Nutrients, 2019).",
        "лайфхак": "Свари гречку сразу на 2 порции — на завтра будет готовый гарнир за 0 минут.",
        "фото_запрос": "buckwheat chicken bowl"
    },
    {
        "тема": "Творожная запеканка с ягодами",
        "тип": "рецепт",
        "категория": "Завтрак",
        "время": "35 минут",
        "продукты": [
            "Творог 5% (150 г) — 30 руб.",
            "Яйцо (1 шт.) — 10 руб.",
            "Манка (15 г) — 2 руб.",
            "Ягоды замороженные (50 г) — 13 руб."
        ],
        "итого": "~55 рублей",
        "способ": [
            "Смешай творог, яйцо и манку до однородности.",
            "Добавь ягоды (можно не размораживать).",
            "Выложи в небольшую форму/кружку и запекай 25–30 минут при 180°C.",
            "Остуди 5 минут — так запеканка лучше держит форму."
        ],
        "нутриенты": "Калории: 320 ккал | Белки: 28 г | Жиры: 12 г | Углеводы: 26 г",
        "польза": "Молочные белки (сывороточный/казеин) — удобный источник незаменимых аминокислот; см. обзор по молочным белкам и восстановлению (Sports Medicine, 2014).",
        "лайфхак": "Нет духовки — сделай в микроволновке 4–5 минут на средней мощности (следи, чтобы не пересушить).",
        "фото_запрос": "cottage cheese casserole berries"
    },
    {
        "тема": "Овсянка с бананом и орехами",
        "тип": "рецепт",
        "категория": "Завтрак",
        "время": "5 минут",
        "продукты": [
            "Овсяные хлопья (50 г) — 6 руб.",
            "Молоко (200 мл) — 10 руб.",
            "Банан (1/2 шт.) — 10 руб.",
            "Орехи (10 г) — 12 руб."
        ],
        "итого": "~38 рублей",
        "способ": [
            "Смешай овсянку с молоком, прогрей 2–3 минуты (или залей кипятком).",
            "Добавь банан кружочками и орехи.",
            "По желанию — щепотка корицы."
        ],
        "нутриенты": "Калории: 360 ккал | Белки: 14 г | Жиры: 12 г | Углеводы: 52 г",
        "польза": "Овёс содержит бета-глюканы, которые связаны с улучшением липидного профиля при регулярном употреблении; см. обзор (British Journal of Nutrition, 2014).",
        "лайфхак": "Держи порционные пакетики овсянки дома/в офисе — завтрак всегда под рукой.",
        "фото_запрос": "oatmeal banana nuts bowl"
    },
    {
        "тема": "Куриные котлеты на пару с брокколи",
        "тип": "рецепт",
        "категория": "Ужин",
        "время": "30 минут",
        "продукты": [
            "Куриная грудка (200 г) — 50 руб.",
            "Яйцо (1 шт.) — 10 руб.",
            "Брокколи замороженная (150 г) — 20 руб."
        ],
        "итого": "~80 рублей",
        "способ": [
            "Прокрути курицу в фарш (или мелко нарежь), добавь яйцо, соль и специи.",
            "Сформируй 2–3 котлеты и готовь на пару 12–15 минут.",
            "Брокколи приготовь на пару/в микроволновке 4–6 минут.",
            "Подавай вместе, добавь лимонный сок по желанию."
        ],
        "нутриенты": "Калории: 410 ккал | Белки: 46 г | Жиры: 16 г | Углеводы: 18 г",
        "польза": "Постный белок помогает поддерживать мышечную массу при снижении веса в сочетании с тренировками; см. обзор (The American Journal of Clinical Nutrition, 2015).",
        "лайфхак": "Добавь в фарш 1–2 ст. л. воды — котлеты будут сочнее без лишних калорий.",
        "фото_запрос": "steamed chicken patties broccoli"
    },
    {
        "тема": "Рыбные стейки с киноа",
        "тип": "рецепт",
        "категория": "Ужин",
        "время": "25 минут",
        "продукты": [
            "Стейк минтая/хека (200 г) — 70 руб.",
            "Киноа (60 г сухой) — 30 руб.",
            "Лимон (1/2 шт.) — 10 руб.",
            "Оливковое масло (1 ч. л.) — 15 руб."
        ],
        "итого": "~125 рублей",
        "способ": [
            "Киноа промой и отвари 15 минут (1:2 с водой).",
            "Рыбу посоли, сбрызни лимоном, обжарь 3–4 минуты с каждой стороны (или запеки 12–15 минут).",
            "Подавай рыбу на подушке из киноа, добавь каплю масла."
        ],
        "нутриенты": "Калории: 520 ккал | Белки: 40 г | Жиры: 18 г | Углеводы: 52 г",
        "польза": "Рыба — источник омега‑3 и высококачественного белка; обзоры связывают потребление рыбы с кардиометаболическими преимуществами (Circulation, 2017).",
        "лайфхак": "Если киноа дороговато — замени на перловку: тоже насыщает и хорошо дружит с рыбой.",
        "фото_запрос": "white fish quinoa plate"
    },
    {
        "тема": "Белковый смузи",
        "тип": "рецепт",
        "категория": "Перекус",
        "время": "3 минуты",
        "продукты": [
            "Кефир 1% (300 мл) — 18 руб.",
            "Творог 2–5% (100 г) — 17 руб.",
            "Банан (1/2 шт.) — 10 руб."
        ],
        "итого": "~45 рублей",
        "способ": [
            "Сложи всё в блендер.",
            "Пробей 20–30 секунд до гладкости.",
            "Пей сразу или убери в холодильник на 30 минут."
        ],
        "нутриенты": "Калории: 260 ккал | Белки: 22 г | Жиры: 6 г | Углеводы: 32 г",
        "польза": "Белок после тренировки поддерживает восстановление мышц; см. позиционный документ по таймингу белка (Journal of the International Society of Sports Nutrition, 2017).",
        "лайфхак": "Добавь лёд и корицу — вкус «молочного коктейля», а калорий меньше.",
        "фото_запрос": "protein smoothie glass"
    },
    {
        "тема": "Салат с тунцом и авокадо",
        "тип": "рецепт",
        "категория": "Обед",
        "время": "10 минут",
        "продукты": [
            "Тунец консервированный (1/2 банки) — 60 руб.",
            "Авокадо (1/2 шт.) — 45 руб.",
            "Салат/айсберг (50 г) — 15 руб.",
            "Томаты черри (50 г) — 10 руб."
        ],
        "итого": "~130 рублей",
        "способ": [
            "Нарежь салат, авокадо и черри.",
            "Добавь тунец, разомни вилкой крупными кусочками.",
            "Заправь лимонным соком/йогуртом, посоли по вкусу."
        ],
        "нутриенты": "Калории: 430 ккал | Белки: 30 г | Жиры: 28 г | Углеводы: 18 г",
        "польза": "Мононенасыщенные жиры (как в авокадо) часто связывают с лучшими показателями кардиометаболического здоровья; см. обзор (The Journal of Nutrition, 2016).",
        "лайфхак": "Чтобы авокадо не темнел — сразу сбрызни лимоном и держи косточку рядом в контейнере.",
        "фото_запрос": "tuna avocado salad bowl"
    },
    {
        "тема": "Фриттата с овощами",
        "тип": "рецепт",
        "категория": "Завтрак",
        "время": "15 минут",
        "продукты": [
            "Яйца (3 шт.) — 30 руб.",
            "Сладкий перец (1/2 шт.) — 15 руб.",
            "Кабачок (1/3 шт.) — 10 руб.",
            "Сыр (30 г) — 20 руб.",
            "Лук (1/2 шт.) — 5 руб."
        ],
        "итого": "~80 рублей",
        "способ": [
            "Нарежь овощи и обжарь 3–4 минуты.",
            "Взбей яйца, вылей на овощи, посоли.",
            "Посыпь сыром и готовь под крышкой 6–7 минут.",
            "Дай постоять 1 минуту и нарежь."
        ],
        "нутриенты": "Калории: 420 ккал | Белки: 26 г | Жиры: 30 г | Углеводы: 14 г",
        "польза": "Блюда с овощами повышают общую плотность нутриентов в рационе; см. обзор о потреблении овощей и здоровье (BMJ, 2017).",
        "лайфхак": "Сделай фриттату в духовке в форме — удобно резать на порции на 2 дня.",
        "фото_запрос": "vegetable frittata skillet"
    },
    {
        "тема": "Куриная грудка с бататом",
        "тип": "рецепт",
        "категория": "Ужин",
        "время": "40 минут",
        "продукты": [
            "Куриная грудка (200 г) — 55 руб.",
            "Батат (250 г) — 40 руб.",
            "Оливковое масло (1 ч. л.) — 10 руб."
        ],
        "итого": "~105 рублей",
        "способ": [
            "Нарежь батат дольками, сбрызни маслом, посоли.",
            "Запекай батат 25–30 минут при 200°C.",
            "Грудку посоли, добавь специи, запеки рядом 18–20 минут (или обжарь 6–8 минут).",
            "Подавай вместе, добавь зелень."
        ],
        "нутриенты": "Калории: 540 ккал | Белки: 46 г | Жиры: 16 г | Углеводы: 60 г",
        "польза": "Углеводы в ужине помогают восстановлению запасов гликогена после интенсивных тренировок; см. обзор (Sports Medicine, 2018).",
        "лайфхак": "Запекай батат сразу на 2–3 порции — потом разогрев 2 минуты.",
        "фото_запрос": "chicken sweet potato meal"
    },
    {
        "тема": "Творог с мёдом и орехами",
        "тип": "рецепт",
        "категория": "Перекус",
        "время": "2 минуты",
        "продукты": [
            "Творог 5% (200 г) — 45 руб.",
            "Мёд (15 г) — 8 руб.",
            "Орехи (10 г) — 5 руб."
        ],
        "итого": "~58 рублей",
        "способ": [
            "Выложи творог в миску.",
            "Добавь мёд и орехи.",
            "Перемешай и ешь."
        ],
        "нутриенты": "Калории: 340 ккал | Белки: 32 г | Жиры: 16 г | Углеводы: 18 г",
        "польза": "Казеин из творога — «долгоиграющий» белок, который может поддерживать ночное восстановление; см. обзор (Journal of Nutrition, 2016).",
        "лайфхак": "Если хочется десерт — добавь какао-порошок 1 ч. л. (почти без сахара).",
        "фото_запрос": "cottage cheese honey nuts"
    },
    {
        "тема": "Рис с индейкой и овощами",
        "тип": "рецепт",
        "категория": "Обед",
        "время": "20 минут",
        "продукты": [
            "Филе индейки (150 г) — 60 руб.",
            "Рис (80 г сухой) — 10 руб.",
            "Овощная смесь замороженная (150 г) — 25 руб.",
            "Соевый соус (1 ст. л.) — 5 руб."
        ],
        "итого": "~100 рублей",
        "способ": [
            "Поставь рис вариться 15 минут.",
            "Индейку нарежь, обжарь/потуши 6–7 минут.",
            "Добавь овощную смесь и готовь ещё 5 минут.",
            "Смешай с рисом и соевым соусом."
        ],
        "нутриенты": "Калории: 560 ккал | Белки: 38 г | Жиры: 12 г | Углеводы: 78 г",
        "польза": "Достаточное потребление белка в течение дня связано с сохранением безжировой массы при дефиците калорий; см. мета-анализ (The American Journal of Clinical Nutrition, 2015).",
        "лайфхак": "Если времени мало — используй пакетики риса для микроволновки.",
        "фото_запрос": "turkey rice vegetables bowl"
    },
    {
        "тема": "Чечевичный суп",
        "тип": "рецепт",
        "категория": "Обед",
        "время": "25 минут",
        "продукты": [
            "Чечевица (70 г сухой) — 14 руб.",
            "Морковь (1 шт.) — 7 руб.",
            "Лук (1 шт.) — 6 руб.",
            "Томаты в собственном соку (150 г) — 15 руб.",
            "Специи/соль — 4 руб."
        ],
        "итого": "~46 рублей",
        "способ": [
            "Лук и морковь нарежь, прогрей в кастрюле 2 минуты.",
            "Добавь чечевицу и 700 мл воды, вари 15 минут.",
            "Добавь томаты и специи, провари ещё 5 минут.",
            "По желанию пробей блендером до крем-супа."
        ],
        "нутриенты": "Калории: 360 ккал | Белки: 22 г | Жиры: 6 г | Углеводы: 54 г",
        "польза": "Бобовые — источник клетчатки и растительного белка; обзоры связывают их с улучшением контроля глюкозы и липидов (The Lancet, 2019).",
        "лайфхак": "Добавь копчёную паприку — вкус станет «как с колбаской», но без неё.",
        "фото_запрос": "lentil soup bowl"
    },
    {
        "тема": "Сырники без муки",
        "тип": "рецепт",
        "категория": "Завтрак",
        "время": "15 минут",
        "продукты": [
            "Творог 5% (100 г) — 22 руб.",
            "Яйцо (1 шт.) — 10 руб.",
            "Подсластитель/сахар (по вкусу) — 1 руб.",
            "Масло для жарки (1 ч. л.) — 2 руб."
        ],
        "итого": "~35 рублей",
        "способ": [
            "Смешай творог, яйцо и подсластитель.",
            "Сформируй 2–3 небольших сырника (масса будет мягкой).",
            "Обжарь на слабом огне по 2–3 минуты с каждой стороны.",
            "Доведи под крышкой ещё 2 минуты."
        ],
        "нутриенты": "Калории: 250 ккал | Белки: 18 г | Жиры: 14 г | Углеводы: 12 г",
        "польза": "Продукты с высоким содержанием белка увеличивают термический эффект пищи и могут поддерживать сытость; см. обзор (Proceedings of the Nutrition Society, 2015).",
        "лайфхак": "Чтобы сырники не разваливались — возьми творог посуше или отожми через марлю.",
        "фото_запрос": "flourless syrniki cottage cheese pancakes"
    },
    {
        "тема": "Тёплый салат с курицей",
        "тип": "рецепт",
        "категория": "Ужин",
        "время": "20 минут",
        "продукты": [
            "Куриная грудка (150 г) — 40 руб.",
            "Микс салата (70 г) — 20 руб.",
            "Томаты черри (60 г) — 10 руб.",
            "Огурец (1/2 шт.) — 8 руб.",
            "Йогурт натуральный (50 г) — 7 руб."
        ],
        "итого": "~85 рублей",
        "способ": [
            "Курицу обжарь/потуши 8–10 минут, посоли и добавь специи.",
            "В миске смешай салат, огурец и черри.",
            "Сверху выложи тёплую курицу.",
            "Заправь йогуртом (можно с горчицей/лимоном)."
        ],
        "нутриенты": "Калории: 380 ккал | Белки: 36 г | Жиры: 14 г | Углеводы: 22 г",
        "польза": "Высокобелковый ужин может улучшать суточную сытость при контроле веса; см. обзор (Obesity Reviews, 2016).",
        "лайфхак": "Сделай «соус» из йогурта + чеснок + лимон — вкус как в кафе.",
        "фото_запрос": "warm chicken salad"
    },
    {
        "тема": "Запечённая рыба с овощами",
        "тип": "рецепт",
        "категория": "Ужин",
        "время": "30 минут",
        "продукты": [
            "Филе минтая (200 г) — 55 руб.",
            "Кабачок (150 г) — 18 руб.",
            "Морковь (1 шт.) — 7 руб.",
            "Растительное масло (1 ч. л.) — 10 руб.",
            "Соль/специи — 10 руб."
        ],
        "итого": "~100 рублей",
        "способ": [
            "Нарежь овощи, выложи в форму, сбрызни маслом и посоли.",
            "Сверху положи рыбу, добавь специи и лимон по желанию.",
            "Запекай 20–25 минут при 190°C.",
            "Подавай сразу, пока рыба сочная."
        ],
        "нутриенты": "Калории: 390 ккал | Белки: 34 г | Жиры: 14 г | Углеводы: 28 г",
        "польза": "Рацион с достаточным количеством овощей связан с более низкими рисками хронических заболеваний; см. мета-анализ (BMJ, 2017).",
        "лайфхак": "Добавь замороженную цветную капусту — и овощей станет больше без лишних затрат.",
        "фото_запрос": "baked fish vegetables tray"
    },
    {
        "тема": "Протеиновые панкейки",
        "тип": "рецепт",
        "категория": "Завтрак",
        "время": "10 минут",
        "продукты": [
            "Овсяные хлопья (40 г) — 6 руб.",
            "Яйцо (1 шт.) — 10 руб.",
            "Банан (1/2 шт.) — 10 руб.",
            "Творог (80 г) — 15 руб.",
            "Разрыхлитель (щепотка) — 2 руб.",
            "Йогурт (30 г) — 2 руб."
        ],
        "итого": "~45 рублей",
        "способ": [
            "Пробей овсянку в «муку» (или возьми готовую).",
            "Смешай яйцо, банан, творог и овсянку, добавь разрыхлитель.",
            "Жарь маленькие панкейки на антипригарной сковороде 2–3 минуты с каждой стороны.",
            "Подай с ложкой йогурта."
        ],
        "нутриенты": "Калории: 390 ккал | Белки: 24 г | Жиры: 12 г | Углеводы: 50 г",
        "польза": "Белковые продукты на завтрак помогают поддерживать суточное потребление белка, что важно для мышечной массы; см. обзор (Sports Medicine, 2014).",
        "лайфхак": "Не переворачиваются? Сделай огонь ниже — и дай «схватиться» сверху 20 секунд.",
        "фото_запрос": "protein pancakes stack"
    },
    {
        "тема": "Боул с киноа и курицей",
        "тип": "рецепт",
        "категория": "Обед",
        "время": "25 минут",
        "продукты": [
            "Киноа (50 г сухой) — 25 руб.",
            "Куриная грудка (150 г) — 40 руб.",
            "Огурец (1/2 шт.) — 8 руб.",
            "Томат (1/2 шт.) — 7 руб.",
            "Йогурт натуральный (50 г) — 10 руб."
        ],
        "итого": "~90 рублей",
        "способ": [
            "Киноа промой и отвари 15 минут.",
            "Курицу обжарь/запеки 10–12 минут, нарежь.",
            "Собери боул: киноа + овощи + курица.",
            "Заправь йогуртом с солью/лимоном."
        ],
        "нутриенты": "Калории: 540 ккал | Белки: 40 г | Жиры: 14 г | Углеводы: 64 г",
        "польза": "Сбалансированные блюда (белок+клетчатка+углеводы) помогают стабилизировать насыщение; см. обзор (Appetite, 2016).",
        "лайфхак": "Киноа можно заменить булгуром — дешевле, вкусно и тоже быстро.",
        "фото_запрос": "quinoa chicken bowl"
    },
    {
        "тема": "Греческий йогурт с ягодами",
        "тип": "рецепт",
        "категория": "Перекус",
        "время": "2 минуты",
        "продукты": [
            "Йогурт греческий (170 г) — 35 руб.",
            "Ягоды замороженные (60 г) — 15 руб."
        ],
        "итого": "~50 рублей",
        "способ": [
            "Выложи йогурт в миску.",
            "Добавь ягоды (можно слегка разморозить).",
            "Перемешай — готово."
        ],
        "нутриенты": "Калории: 210 ккал | Белки: 17 г | Жиры: 6 г | Углеводы: 24 г",
        "польза": "Ферментированные молочные продукты связывают с благоприятными метаболическими показателями в наблюдательных исследованиях; см. обзор (The American Journal of Clinical Nutrition, 2017).",
        "лайфхак": "Для хруста добавь 1 ч. л. семечек — вкуснее, а порция всё равно лёгкая.",
        "фото_запрос": "greek yogurt berries bowl"
    },
    {
        "тема": "Омлет-рулет с семгой",
        "тип": "рецепт",
        "категория": "Завтрак",
        "время": "12 минут",
        "продукты": [
            "Яйца (2 шт.) — 20 руб.",
            "Сёмга слабосолёная (50 г) — 70 руб.",
            "Сливочный сыр (30 г) — 15 руб.",
            "Укроп (пучок/щепотка) — 5 руб."
        ],
        "итого": "~110 рублей",
        "способ": [
            "Взбей яйца с солью, вылей тонким слоем на сковороду.",
            "Готовь 2–3 минуты, пока омлет схватится.",
            "Смажь сливочным сыром, выложи семгу и укроп.",
            "Сверни рулетом и нарежь."
        ],
        "нутриенты": "Калории: 420 ккал | Белки: 28 г | Жиры: 32 г | Углеводы: 6 г",
        "польза": "Рыба и омега‑3 в целом ассоциированы с кардиометаболическими преимуществами; см. научный обзор по омега‑3 (Circulation, 2017).",
        "лайфхак": "Сёмгу можно заменить скумбрией/горбушей — дешевле, а вкус яркий.",
        "фото_запрос": "salmon omelette roll"
    },
    # =================== ТРЕНИРОВКА ДНЯ (30 шт) ===================
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №01 — TABATA Full Body (12 минут)",
        "формат": "TABATA",
        "уровень": "Новичок/Средний",
        "длительность": "12 минут",
        "оборудование": "Без оборудования",
        "цель": "Разгон метаболизма + тонус всего тела",
        "протокол": "20 сек работа / 10 сек отдых × 8 раундов (4 минуты) на блок",
        "разминка": [
            "1 мин: шаг на месте + круги плечами",
            "1 мин: лёгкие приседания",
            "1 мин: наклоны/повороты корпуса",
            "1 мин: прыжки «джампинг джек» (или шаг в стороны для новичка)"
        ],
        "тренировка": [
            {"блок": "Табата 1", "упражнение": "Приседания", "замена": "Сесть на стул и встать", "подсказка": "Колени в линию носков, спина нейтральная"},
            {"блок": "Табата 2", "упражнение": "Отжимания", "замена": "Отжимания от опоры/с колен", "подсказка": "Лопатки стабильно, корпус «доска»"},
            {"блок": "Табата 3", "упражнение": "Планка (на предплечьях)", "замена": "Планка с колен", "подсказка": "Не проваливай поясницу, дыши ровно"}
        ],
        "заминка": [
            "1 мин: спокойное дыхание, шаг",
            "1 мин: растяжка квадрицепса",
            "1 мин: грудные мышцы у стены",
            "1 мин: ягодицы/поясница (поза ребёнка)"
        ],
        "масштабирование": {
            "проще": ["Уменьши темп, делай шаговые варианты вместо прыжков", "Сократи до 2 блоков табаты (8 минут)"],
            "сложнее": ["Добавь 4-й блок табаты: «берпи без прыжка»", "Старайся держать одинаковый темп во всех 8 раундах"]
        },
        "безопасность": [
            "Боль в колене/пояснице — уменьши амплитуду и темп",
            "Дыши: выдох на усилие",
            "Остановись при головокружении"
        ],
        "источник": "Протокол Табата: 20/10×8 (Tabata et al., Med Sci Sports Exerc, 1996)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №02 — EMOM 12 (сила + дыхалка)",
        "формат": "EMOM",
        "уровень": "Любой (масштабируется)",
        "длительность": "12 минут",
        "оборудование": "Без оборудования / коврик",
        "цель": "Сила корпуса + ровное кардио",
        "протокол": "Every Minute On the Minute: в начале каждой минуты делай задание, остаток минуты — отдых",
        "разминка": [
            "1 мин: кошка-корова",
            "1 мин: выпад назад поочерёдно",
            "1 мин: отжимания от опоры",
            "1 мин: лёгкая планка 20 сек + отдых"
        ],
        "тренировка": [
            {"минута": "1,4,7,10", "задание": "10 приседаний + 10 подъёмов коленей", "проще": "8 приседаний", "сложнее": "приседания с прыжком"},
            {"минута": "2,5,8,11", "задание": "8 отжиманий", "проще": "от опоры/с колен", "сложнее": "12 отжиманий"},
            {"минута": "3,6,9,12", "задание": "20 сек планка + 10 скручиваний", "проще": "планка с колен", "сложнее": "планка 30 сек"}
        ],
        "заминка": [
            "2 мин: дыхание 4-2-6 (вдох-пауза-выдох)",
            "1 мин: растяжка бедра спереди",
            "1 мин: растяжка грудных"
        ],
        "масштабирование": {
            "проще": ["Делай меньше повторов, оставляй больше отдыха", "Держи планку 10–15 сек"],
            "сложнее": ["Увеличь повторения на 10–20%", "Старайся закончить задание за 30–35 сек, чтобы отдыхать 25–30 сек"]
        },
        "безопасность": [
            "Не «залипай» в пояснице в планке",
            "Если пульс слишком высокий — уменьши повторения"
        ],
        "источник": "Определение EMOM: Every Minute On the Minute (популярный формат функционального тренинга)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №03 — AMRAP 12 (функционал дома)",
        "формат": "AMRAP",
        "уровень": "Средний",
        "длительность": "12 минут",
        "оборудование": "Без оборудования",
        "цель": "Выносливость + всё тело",
        "протокол": "As Many Rounds As Possible: максимум раундов за время",
        "разминка": [
            "2 мин: шаг + махи руками",
            "1 мин: приседания без веса",
            "1 мин: выпады назад",
            "1 мин: лёгкие берпи без прыжка"
        ],
        "тренировка": [
            "8 приседаний",
            "6 отжиманий",
            "10 выпадов (в сумме на обе ноги)",
            "20 «альпинист» (по 10 на ногу)"
        ],
        "цель_на_сегодня": "Сделай 4–7 раундов в ровном темпе без «умирания» на старте",
        "заминка": [
            "1 мин: дыхание",
            "1 мин: ягодицы (фигура 4)",
            "1 мин: икры у стены"
        ],
        "масштабирование": {
            "проще": ["Отжимания от опоры", "Альпинист — медленно", "Сократи до 10 минут"],
            "сложнее": ["Добавь 5 бёрпи в конце каждого раунда", "Увеличь до 15 минут"]
        },
        "безопасность": [
            "Держи нейтральную поясницу, особенно в альпинисте",
            "Если техника ломается — остановись и сделай паузу"
        ],
        "источник": "Определение AMRAP: As Many Rounds As Possible (популярный формат функционального тренинга)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №04 — HIIT 20 минут (30/30)",
        "формат": "HIIT",
        "уровень": "Новичок/Средний",
        "длительность": "20 минут",
        "оборудование": "Без оборудования",
        "цель": "Кардио + жиросжигание",
        "протокол": "10 раундов: 30 сек работа / 30 сек отдых (смена упражнений по кругу)",
        "разминка": [
            "3 мин: шаг + лёгкие прыжки/шаги в стороны",
            "2 мин: мобилизация таза/голеностопа"
        ],
        "тренировка": [
            {"упражнение": "Джампинг джек", "проще": "шаг в стороны", "сложнее": "с хлопком над головой"},
            {"упражнение": "Высокие колени", "проще": "марш с коленями", "сложнее": "бег на месте"},
            {"упражнение": "Присед + подъём на носки", "проще": "полуприсед", "сложнее": "присед + прыжок"},
            {"упражнение": "Альпинист", "проще": "медленно", "сложнее": "быстро"}
        ],
        "как_делать": "Крути упражнения по кругу, пока не пройдёшь 10 раундов (20 минут вместе с отдыхом).",
        "заминка": [
            "3 мин: ходьба + дыхание",
            "2 мин: растяжка передней поверхности бедра и груди"
        ],
        "масштабирование": {
            "проще": ["Делай 20/40 вместо 30/30", "Уменьши до 14–16 минут"],
            "сложнее": ["Делай 40/20", "Добавь 2–4 раунда"]
        },
        "безопасность": [
            "Соблюдай мягкую амортизацию, не «бей» пятками",
            "В прыжках держи колени в линию носков"
        ],
        "источник": "HIIT — интервальная тренировка высокой интенсивности (универсальный формат, широко описан в спортивной литературе)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №05 — TABATA Низ (8 минут)",
        "формат": "TABATA",
        "уровень": "Новичок",
        "длительность": "8 минут",
        "оборудование": "Без оборудования",
        "цель": "Ягодицы/ноги без перегруза",
        "протокол": "2 блока табаты по 4 минуты",
        "разминка": [
            "2 мин: шаг + круги тазом",
            "2 мин: приседания и выпады без веса"
        ],
        "тренировка": [
            {"блок": "Табата 1", "упражнение": "Выпад назад (поочерёдно)", "замена": "выпад до комфортной амплитуды", "подсказка": "корпус ровно"},
            {"блок": "Табата 2", "упражнение": "Ягодичный мост", "замена": "мост с паузой 1 сек", "подсказка": "толкайся пятками"}
        ],
        "заминка": [
            "2 мин: растяжка сгибателей бедра и ягодиц"
        ],
        "масштабирование": {
            "проще": ["Сократи амплитуду выпадов", "Делай медленнее"],
            "сложнее": ["Добавь 3-й блок: «приседания»", "В мосту держи паузу 2 сек"]
        },
        "безопасность": [
            "Колени не заваливай внутрь",
            "Поясницу в мосту не переразгибай"
        ],
        "источник": "Протокол Табата: 20/10×8 (Tabata et al., 1996)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №06 — EMOM 10 (корпус + плечи)",
        "формат": "EMOM",
        "уровень": "Средний",
        "длительность": "10 минут",
        "оборудование": "Коврик",
        "цель": "Сильный корпус, осанка",
        "протокол": "EMOM 10: 5 циклов из 2 минут",
        "разминка": [
            "2 мин: круги плечами + махи руками",
            "2 мин: планка 15 сек + отдых"
        ],
        "тренировка": [
            {"минута": "нечётные (1,3,5,7,9)", "задание": "10 «супермен» + 10 «лодочка» (коротко)", "проще": "только супермен", "сложнее": "добавь паузу 1 сек"},
            {"минута": "чётные (2,4,6,8,10)", "задание": "8–12 отжиманий (любой вариант)", "проще": "от опоры", "сложнее": "узкие отжимания"}
        ],
        "заминка": [
            "2 мин: растяжка грудных и плеч",
            "1 мин: поза ребёнка"
        ],
        "масштабирование": {
            "проще": ["Сократи отжимания до 5–6", "Делай супермен медленно"],
            "сложнее": ["Увеличь отжимания до 12–15", "Добавь 5 сек планки в конце минуты"]
        },
        "безопасность": [
            "В супермене не ломай шею — взгляд в пол",
            "Если болит поясница — уменьши амплитуду"
        ],
        "источник": "EMOM = задание в начале каждой минуты, остаток — восстановление"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №07 — AMRAP 15 (без прыжков)",
        "формат": "AMRAP",
        "уровень": "Новичок/Средний",
        "длительность": "15 минут",
        "оборудование": "Без оборудования",
        "цель": "Кардио без ударной нагрузки",
        "протокол": "AMRAP 15 минут",
        "разминка": [
            "5 мин: ходьба + мобилизация голеностопа/таза"
        ],
        "тренировка": [
            "10 приседаний (контрольные)",
            "10 наклонов «доброе утро» (без веса)",
            "8 отжиманий",
            "12 шагов выпад назад (в сумме)"
        ],
        "цель_на_сегодня": "Держи разговорный темп: ты должен(на) говорить фразами.",
        "заминка": [
            "2 мин: дыхание + растяжка бёдер"
        ],
        "масштабирование": {
            "проще": ["Отжимания от опоры", "Сократи до 12 минут"],
            "сложнее": ["Добавь 20 сек планки в конце каждого раунда", "Сократи отдых до минимума"]
        },
        "безопасность": [
            "Спина нейтральная в наклонах",
            "Не форсируй глубину приседа при дискомфорте"
        ],
        "источник": "AMRAP — максимум раундов за фиксированное время"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №08 — HIIT Лестница 10 минут (20→40)",
        "формат": "HIIT",
        "уровень": "Средний",
        "длительность": "10 минут",
        "оборудование": "Без оборудования",
        "цель": "Быстрый «памп» и кардио",
        "протокол": "Лестница: 20/40, 30/30, 40/20 — по 2 раунда каждого шага",
        "разминка": [
            "3 мин: марш + суставная разминка"
        ],
        "тренировка": [
            {"упражнение": "Берпи без прыжка", "проще": "шаг назад вместо прыжка", "сложнее": "классический берпи"},
            {"упражнение": "Приседания", "проще": "на стул", "сложнее": "пульс внизу 2–3 раза"},
            {"упражнение": "Альпинист", "проще": "медленно", "сложнее": "быстро"}
        ],
        "заминка": [
            "2 мин: ходьба + дыхание"
        ],
        "масштабирование": {
            "проще": ["Сделай только 20/40 и 30/30 (6 минут)", "Исключи берпи"],
            "сложнее": ["Добавь ещё 1 «ступень» 50/10", "Держи темп ровно на 40/20"]
        },
        "безопасность": [
            "Берпи — только с контролем поясницы",
            "Не задерживай дыхание"
        ],
        "источник": "HIIT-лестницы — распространённый универсальный подход к прогрессии интервалов"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №09 — TABATA Верх + корпус (8 минут)",
        "формат": "TABATA",
        "уровень": "Средний",
        "длительность": "8 минут",
        "оборудование": "Коврик",
        "цель": "Плечи/грудь + пресс",
        "протокол": "2 блока табаты по 4 минуты",
        "разминка": [
            "2 мин: круги плечами, мобилизация грудного отдела",
            "2 мин: отжимания от опоры 6–8 раз"
        ],
        "тренировка": [
            {"блок": "Табата 1", "упражнение": "Отжимания", "замена": "от опоры/с колен", "подсказка": "локти ~45°"},
            {"блок": "Табата 2", "упражнение": "Скручивания + подъём коленей лёжа", "замена": "только скручивания", "подсказка": "не тянем шею руками"}
        ],
        "заминка": [
            "2 мин: растяжка грудных/плеч"
        ],
        "масштабирование": {
            "проще": ["Сделай 1 блок табаты (4 минуты)", "Убери подъём коленей"],
            "сложнее": ["Добавь 3-й блок: планка", "В отжиманиях добавь паузу внизу"]
        },
        "безопасность": [
            "Шея расслаблена в упражнениях на пресс",
            "Не прогибайся в пояснице"
        ],
        "источник": "Протокол Табата: 20/10×8 (Tabata et al., 1996)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №10 — EMOM 14 (полное тело, ровный темп)",
        "формат": "EMOM",
        "уровень": "Любой",
        "длительность": "14 минут",
        "оборудование": "Без оборудования",
        "цель": "Стабильная нагрузка без «задохнуться»",
        "протокол": "EMOM 14: 7 циклов из 2 минут",
        "разминка": [
            "4 мин: шаг + присед + лёгкая планка"
        ],
        "тренировка": [
            {"минута": "1,3,5,7,9,11,13", "задание": "12 приседаний + 8 отжиманий", "проще": "8+6", "сложнее": "15+10"},
            {"минута": "2,4,6,8,10,12,14", "задание": "20 шагов выпад назад + 20 сек планка", "проще": "12 шагов + 10 сек", "сложнее": "30 шагов + 30 сек"}
        ],
        "заминка": [
            "3 мин: дыхание + растяжка бёдер и груди"
        ],
        "масштабирование": {
            "проще": ["Сократи до 10 минут", "Снизь повторения на 20–30%"],
            "сложнее": ["Держи планку в конце каждой чётной минуты 30 сек", "Увеличь приседания до 15–18"]
        },
        "безопасность": [
            "Сохраняй технику: лучше меньше повторов, но качественно",
            "Если пульс улетает — увеличь отдых (снизь объём)"
        ],
        "источник": "EMOM — формат, где качество повторов важнее «добить любой ценой»"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №11 — AMRAP 10 (корпус + ягодицы)",
        "формат": "AMRAP",
        "уровень": "Новичок/Средний",
        "длительность": "10 минут",
        "оборудование": "Коврик",
        "цель": "Ягодицы + пресс без прыжков",
        "протокол": "AMRAP 10 минут",
        "разминка": ["2 мин: мост + кошка-корова", "2 мин: приседания лёгкие"],
        "тренировка": ["12 ягодичный мост", "10 скручиваний", "10 выпадов назад (в сумме)", "20 сек планка"],
        "заминка": ["2 мин: растяжка ягодиц/бедра"],
        "масштабирование": {"проще": ["Планка 10 сек", "Убери скручивания при дискомфорте в шее"], "сложнее": ["Добавь паузу 2 сек в мосту", "AMRAP 12 минут"]},
        "безопасность": ["Шея расслаблена в скручиваниях", "Поясницу не переразгибай"],
        "источник": "AMRAP — максимум раундов за фиксированное время"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №12 — HIIT 16 минут (40/20)",
        "формат": "HIIT",
        "уровень": "Средний",
        "длительность": "16 минут",
        "оборудование": "Без оборудования",
        "цель": "Кардио + всё тело",
        "протокол": "8 раундов: 40 сек работа / 20 сек отдых (4 упражнения по кругу ×2)",
        "разминка": ["4 мин: шаг + мобилизация голеностопа/таза"],
        "тренировка": [
            {"упражнение": "Присед + колено вверх", "проще": "присед", "сложнее": "присед + прыжок"},
            {"упражнение": "Отжимания", "проще": "от опоры", "сложнее": "с паузой"},
            {"упражнение": "Альпинист", "проще": "медленно", "сложнее": "быстро"},
            {"упражнение": "Планка с касанием плеч", "проще": "обычная планка", "сложнее": "касания быстрее"}
        ],
        "заминка": ["2–3 мин: ходьба + дыхание", "1–2 мин: грудные/бедро"],
        "масштабирование": {"проще": ["Сделай 30/30", "Уменьши до 12 минут"], "сложнее": ["Добавь 3-й круг (24 минуты)", "Держи темп одинаковым"]},
        "безопасность": ["В планке не проваливай поясницу", "Отдыхай, если техника ломается"],
        "источник": "HIIT — интервалы высокой интенсивности (широко используемый формат)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №13 — EMOM 12 (ноги + корпус)",
        "формат": "EMOM",
        "уровень": "Любой",
        "длительность": "12 минут",
        "оборудование": "Без оборудования",
        "цель": "Ноги + стабильный корпус",
        "протокол": "EMOM 12: 6 циклов из 2 минут",
        "разминка": ["4 мин: присед/выпад/планка по 20 сек"],
        "тренировка": [
            {"минута": "нечётные", "задание": "14 приседаний", "проще": "10", "сложнее": "18"},
            {"минута": "чётные", "задание": "12 выпадов назад (в сумме) + 10 сек планка", "проще": "8 + 5 сек", "сложнее": "16 + 20 сек"}
        ],
        "заминка": ["3 мин: растяжка квадрицепса/ягодиц"],
        "масштабирование": {"проще": ["Сократи приседания на 30%", "Планка с колен"], "сложнее": ["Добавь 3-й элемент: 10 подъёмов коленей стоя"]},
        "безопасность": ["Колени в линию носков", "Корпус собран"],
        "источник": "EMOM — «задание в начале минуты, отдых в остатке»"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №14 — TABATA Кардио (4 минуты, без оборудования)",
        "формат": "TABATA",
        "уровень": "Средний",
        "длительность": "4 минуты",
        "оборудование": "Без оборудования",
        "цель": "Быстрый кардио-буст",
        "протокол": "1 блок табаты: 20/10 × 8",
        "разминка": ["3 мин: шаг + мобилизация", "30 сек: лёгкие прыжки/шаги"],
        "тренировка": [
            {"блок": "Табата", "упражнение": "Высокие колени", "замена": "марш с коленями", "подсказка": "корпус высокий"}
        ],
        "заминка": ["2 мин: ходьба + дыхание"],
        "масштабирование": {"проще": ["Марш вместо бега"], "сложнее": ["Добавь 2-й блок табаты: джампинг джек"]},
        "безопасность": ["Мягкая амортизация, не бей пятками"],
        "источник": "Протокол Табата: 20/10×8 (Tabata et al., 1996)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №15 — AMRAP 15 (верх + ноги)",
        "формат": "AMRAP",
        "уровень": "Средний",
        "длительность": "15 минут",
        "оборудование": "Без оборудования",
        "цель": "Сила + выносливость",
        "протокол": "AMRAP 15 минут",
        "разминка": ["5 мин: шаг + суставная разминка"],
        "тренировка": ["6 отжиманий", "12 приседаний", "10 выпадов (в сумме)", "20 сек планка"],
        "заминка": ["3 мин: растяжка грудных/бёдер"],
        "масштабирование": {"проще": ["Отжимания от опоры", "AMRAP 12"], "сложнее": ["Добавь 6 «альпинист» на каждую ногу в конце раунда"]},
        "безопасность": ["Не жертвуй техникой ради раундов"],
        "источник": "AMRAP — формат на стабильную работу в темпе"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №16 — HIIT 12 минут (интервалы 45/15)",
        "формат": "HIIT",
        "уровень": "Продвинутый (масштабируется)",
        "длительность": "12 минут",
        "оборудование": "Без оборудования",
        "цель": "Интенсивность + кардио",
        "протокол": "6 раундов: 45 сек работа / 15 сек отдых (2 упражнения чередуются)",
        "разминка": ["4 мин: разогрев + лёгкая планка"],
        "тренировка": [
            {"упражнение": "Берпи без прыжка", "проще": "шаг назад", "сложнее": "классический берпи"},
            {"упражнение": "Присед + выпрыгивание (по желанию)", "проще": "присед", "сложнее": "прыжок"}
        ],
        "заминка": ["3 мин: ходьба + дыхание"],
        "масштабирование": {"проще": ["Сделай 30/30", "Убери прыжки"], "сложнее": ["Сделай 8 раундов (16 минут)"]},
        "безопасность": ["Берпи только с контролем поясницы"],
        "источник": "HIIT — интервальный формат; прогрессируй плавно"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №17 — EMOM 20 (ровный прогресс)",
        "формат": "EMOM",
        "уровень": "Средний",
        "длительность": "20 минут",
        "оборудование": "Без оборудования",
        "цель": "Объём без хаоса",
        "протокол": "EMOM 20: 5 циклов из 4 минут",
        "разминка": ["5 мин: шаг + присед + отжимания от опоры"],
        "тренировка": [
            {"минута": "1,5,9,13,17", "задание": "15 приседаний", "проще": "12", "сложнее": "18"},
            {"минута": "2,6,10,14,18", "задание": "10 отжиманий", "проще": "6–8", "сложнее": "12"},
            {"минута": "3,7,11,15,19", "задание": "20 выпадов (в сумме)", "проще": "14", "сложнее": "24"},
            {"минута": "4,8,12,16,20", "задание": "30 сек планка", "проще": "15 сек", "сложнее": "40 сек"}
        ],
        "заминка": ["3–4 мин: растяжка ног/груди"],
        "масштабирование": {"проще": ["Сократи до EMOM 12"], "сложнее": ["Увеличь планку до 40 сек стабильно"]},
        "безопасность": ["Планка — без провала поясницы"],
        "источник": "EMOM помогает держать одинаковый темп и качество"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №18 — TABATA Пресс + кардио (8 минут)",
        "формат": "TABATA",
        "уровень": "Средний",
        "длительность": "8 минут",
        "оборудование": "Коврик",
        "цель": "Корпус + дыхание",
        "протокол": "2 блока табаты по 4 минуты",
        "разминка": ["3 мин: мобилизация + лёгкая планка 10 сек"],
        "тренировка": [
            {"блок": "Табата 1", "упражнение": "Альпинист", "замена": "медленный альпинист", "подсказка": "корпус стабилен"},
            {"блок": "Табата 2", "упражнение": "Скручивания", "замена": "короткие скручивания", "подсказка": "не тяни шею"}
        ],
        "заминка": ["2 мин: поза ребёнка + дыхание"],
        "масштабирование": {"проще": ["Альпинист медленно", "Сделай 1 блок"], "сложнее": ["Добавь 3-й блок: планка"]},
        "безопасность": ["Шея расслаблена, поясница под контролем"],
        "источник": "Протокол Табата: 20/10×8 (Tabata et al., 1996)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №19 — AMRAP 12 (без прыжков, «умный темп»)",
        "формат": "AMRAP",
        "уровень": "Любой",
        "длительность": "12 минут",
        "оборудование": "Без оборудования",
        "цель": "Выносливость без ударной нагрузки",
        "протокол": "AMRAP 12 минут",
        "разминка": ["4 мин: ходьба + мобилизация"],
        "тренировка": ["12 приседаний", "10 отжиманий от опоры/с колен", "12 наклонов «доброе утро»", "20 шагов на месте с коленями"],
        "заминка": ["3 мин: растяжка задней поверхности бедра и груди"],
        "масштабирование": {"проще": ["Сделай 10 минут"], "сложнее": ["Добавь 20 сек планки в конце раунда"]},
        "безопасность": ["В наклонах держи спину нейтральной"],
        "источник": "AMRAP — ключ: ровное дыхание и стабильная техника"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №20 — HIIT «круг» 18 минут (3×6)",
        "формат": "HIIT",
        "уровень": "Средний",
        "длительность": "18 минут",
        "оборудование": "Без оборудования",
        "цель": "Сжигание калорий + тонус",
        "протокол": "3 круга по 6 минут: 45 сек работа / 15 сек переход",
        "разминка": ["5 мин: шаг + суставная разминка"],
        "тренировка": [
            {"упражнение": "Джампинг джек", "проще": "шаг в стороны", "сложнее": "ускорение"},
            {"упражнение": "Приседания", "проще": "полуприсед", "сложнее": "пульс внизу"},
            {"упражнение": "Отжимания", "проще": "от опоры", "сложнее": "узкие"},
            {"упражнение": "Альпинист", "проще": "медленно", "сложнее": "быстро"},
            {"упражнение": "Планка", "проще": "с колен", "сложнее": "с касанием плеч"},
            {"упражнение": "Выпады назад", "проще": "меньше амплитуда", "сложнее": "выпад + колено вверх"}
        ],
        "заминка": ["3 мин: ходьба + дыхание", "2 мин: растяжка ног"],
        "масштабирование": {"проще": ["Сделай 2 круга (12 минут)"], "сложнее": ["Добавь 4-й круг (24 минуты)"]},
        "безопасность": ["Держи технику, особенно при усталости"],
        "источник": "HIIT-круги — универсальный способ «вписать» тренировку в любой день"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №21 — TABATA «ягодицы + кардио» (8 минут)",
        "формат": "TABATA",
        "уровень": "Средний",
        "длительность": "8 минут",
        "оборудование": "Коврик",
        "цель": "Ноги + пульс без долгих тренировок",
        "протокол": "2 блока табаты по 4 минуты",
        "разминка": ["4 мин: шаг + присед + выпады"],
        "тренировка": [
            {"блок": "Табата 1", "упражнение": "Выпады назад", "замена": "выпады до комфортной амплитуды", "подсказка": "корпус ровно"},
            {"блок": "Табата 2", "упражнение": "Джампинг джек", "замена": "шаг в стороны", "подсказка": "мягкая амортизация"}
        ],
        "заминка": ["2 мин: растяжка бёдер"],
        "масштабирование": {"проще": ["Убери прыжки"], "сложнее": ["Добавь 3-й блок: приседания"]},
        "безопасность": ["Колени в линию носков"],
        "источник": "Протокол Табата: 20/10×8 (Tabata et al., 1996)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №22 — EMOM 8 (быстрый старт)",
        "формат": "EMOM",
        "уровень": "Новичок",
        "длительность": "8 минут",
        "оборудование": "Без оборудования",
        "цель": "Сделать хоть что-то — и почувствовать себя лучше",
        "протокол": "EMOM 8: 4 цикла из 2 минут",
        "разминка": ["2 мин: шаг + круги плечами"],
        "тренировка": [
            {"минута": "нечётные", "задание": "10 приседаний", "проще": "8", "сложнее": "12"},
            {"минута": "чётные", "задание": "6 отжиманий", "проще": "от опоры", "сложнее": "10"}
        ],
        "заминка": ["1–2 мин: дыхание"],
        "масштабирование": {"проще": ["Сделай EMOM 6"], "сложнее": ["Сделай EMOM 12"]},
        "безопасность": ["Не гони темп — оставь 20–30 сек отдыха"],
        "источник": "EMOM — отличный формат для новичков: структура держит дисциплину"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №23 — AMRAP 20 (выносливость)",
        "формат": "AMRAP",
        "уровень": "Средний",
        "длительность": "20 минут",
        "оборудование": "Без оборудования",
        "цель": "Длинная ровная работа без рывков",
        "протокол": "AMRAP 20 минут",
        "разминка": ["5 мин: ходьба + мобилизация"],
        "тренировка": ["15 приседаний", "10 отжиманий", "20 выпадов (в сумме)", "30 сек планка"],
        "цель_на_сегодня": "Дыши носом/смешанно и держи стабильный темп.",
        "заминка": ["4 мин: растяжка ног/груди"],
        "масштабирование": {"проще": ["AMRAP 15", "Планка 15 сек"], "сложнее": ["Добавь 10 «альпинист» на ногу после планки"]},
        "безопасность": ["Если ломается техника — сделай паузу 20–30 сек"],
        "источник": "AMRAP хорошо развивает выносливость за счёт устойчивого темпа"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №24 — HIIT 4×4 (универсальная схема)",
        "формат": "HIIT",
        "уровень": "Средний/Продвинутый",
        "длительность": "22–26 минут",
        "оборудование": "Без оборудования",
        "цель": "Кардио-выносливость",
        "протокол": "4 интервала по 4 минуты работы + 3 минуты лёгкого восстановления между ними",
        "разминка": ["6 мин: ходьба → лёгкий бег/марш", "1 мин: мобилизация голеностопа"],
        "тренировка": [
            {"интервал": "4×4", "как": "4 минуты: чередуй 20 сек «высокие колени» и 20 сек шаг", "пульс": "ориентируйся на «тяжело, но контролируемо»"},
            {"восстановление": "3 минуты", "как": "ходьба + дыхание"}
        ],
        "заминка": ["4–5 мин: ходьба + растяжка икр/бёдер"],
        "масштабирование": {"проще": ["Сделай 3×3", "Только шаговые варианты"], "сложнее": ["Сделай 5×4", "Сократи восстановление до 2 минут"]},
        "безопасность": ["Не начинай с максимума: 1-й интервал — разгон"],
        "источник": "4×4 — популярная схема интервального кардио (часто используется в программировании HIIT)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №25 — TABATA Плечи/корпус (4 минуты)",
        "формат": "TABATA",
        "уровень": "Любой",
        "длительность": "4 минуты",
        "оборудование": "Коврик",
        "цель": "Осанка + корпус",
        "протокол": "1 блок табаты: 20/10 × 8",
        "разминка": ["3–4 мин: круги плечами + кошка-корова"],
        "тренировка": [{"блок": "Табата", "упражнение": "Планка с касанием плеч", "замена": "обычная планка", "подсказка": "таз стабилен"}],
        "заминка": ["2 мин: растяжка грудных"],
        "масштабирование": {"проще": ["Планка с колен"], "сложнее": ["Ускорь касания без «качелей» таза"]},
        "безопасность": ["Поясницу не проваливай"],
        "источник": "Протокол Табата: 20/10×8 (Tabata et al., 1996)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №26 — EMOM 16 (корпус + ноги)",
        "формат": "EMOM",
        "уровень": "Средний",
        "длительность": "16 минут",
        "оборудование": "Без оборудования",
        "цель": "Стабильный объём без хаоса",
        "протокол": "EMOM 16: 4 цикла из 4 минут",
        "разминка": ["5 мин: шаг + присед + выпады"],
        "тренировка": [
            {"минута": "1,5,9,13", "задание": "16 приседаний", "проще": "12", "сложнее": "20"},
            {"минута": "2,6,10,14", "задание": "10 отжиманий", "проще": "6–8", "сложнее": "12"},
            {"минута": "3,7,11,15", "задание": "30 сек планка", "проще": "15 сек", "сложнее": "40 сек"},
            {"минута": "4,8,12,16", "задание": "20 выпадов (в сумме)", "проще": "14", "сложнее": "26"}
        ],
        "заминка": ["3–4 мин: растяжка ног/груди"],
        "масштабирование": {"проще": ["Сократи до 12 минут"], "сложнее": ["Увеличь приседания на +2 в каждом цикле"]},
        "безопасность": ["Качество повторов важнее количества"],
        "источник": "EMOM — формат, где легко отслеживать прогресс"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №27 — AMRAP 12 (домашний «бенчмарк»)",
        "формат": "AMRAP",
        "уровень": "Любой",
        "длительность": "12 минут",
        "оборудование": "Без оборудования",
        "цель": "Проверка формы и прогресса",
        "протокол": "AMRAP 12 минут",
        "разминка": ["5 мин: шаг + 2–3 лёгких круга по 3 повтора каждого упражнения"],
        "тренировка": ["5 отжиманий", "10 приседаний", "15 скручиваний"],
        "цель_на_сегодня": "Запиши число раундов — повтори через 2 недели и сравни.",
        "заминка": ["3 мин: растяжка"],
        "масштабирование": {"проще": ["Отжимания от опоры", "Скручивания заменить на «dead bug» 10/10"], "сложнее": ["Добавь 20 сек планки после каждого раунда"]},
        "безопасность": ["Техника важнее рекорда"],
        "источник": "AMRAP-бенчмарки удобно повторять для отслеживания прогресса"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №28 — HIIT 10 минут (20/40, лёгкие ноги)",
        "формат": "HIIT",
        "уровень": "Новичок/Средний",
        "длительность": "10 минут",
        "оборудование": "Без оборудования",
        "цель": "Кардио без перегруза",
        "протокол": "10 раундов: 20 сек работа / 40 сек отдых",
        "разминка": ["4 мин: ходьба + мобилизация"],
        "тренировка": [
            {"упражнение": "Высокие колени", "проще": "марш", "сложнее": "быстрее"},
            {"упражнение": "Джампинг джек", "проще": "шаг в стороны", "сложнее": "ускорение"}
        ],
        "заминка": ["2–3 мин: ходьба + дыхание"],
        "масштабирование": {"проще": ["Сделай 6–8 раундов"], "сложнее": ["Перейди на 30/30"]},
        "безопасность": ["Следи за амортизацией"],
        "источник": "HIIT 20/40 — мягкий вход в интервалы"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №29 — TABATA «тест» (4 минуты)",
        "формат": "TABATA",
        "уровень": "Продвинутый (масштабируется)",
        "длительность": "4 минуты",
        "оборудование": "Без оборудования",
        "цель": "Проверка мощности",
        "протокол": "1 блок табаты: 20/10 × 8",
        "разминка": ["5 мин: разогрев + 2 лёгких раунда упражнения"],
        "тренировка": [{"блок": "Табата", "упражнение": "Берпи без прыжка", "замена": "шаг назад", "подсказка": "спина нейтральная"}],
        "заминка": ["3 мин: ходьба + дыхание"],
        "масштабирование": {"проще": ["Шаговые варианты"], "сложнее": ["Классический берпи"]},
        "безопасность": ["Если техника ломается — замедлись"],
        "источник": "Протокол Табата: 20/10×8 (Tabata et al., 1996)"
    },
    {
        "тип": "тренировка_дня",
        "тема": "Тренировка дня №30 — EMOM 10 (финишер на всё тело)",
        "формат": "EMOM",
        "уровень": "Любой",
        "длительность": "10 минут",
        "оборудование": "Без оборудования",
        "цель": "Коротко и эффективно",
        "протокол": "EMOM 10",
        "разминка": ["3 мин: шаг + суставная разминка"],
        "тренировка": [
            {"минута": "каждая", "задание": "8 приседаний + 6 отжиманий + 10 сек планка", "проще": "6+4+5 сек", "сложнее": "10+8+20 сек"}
        ],
        "заминка": ["2 мин: растяжка"],
        "масштабирование": {"проще": ["Сделай EMOM 6–8"], "сложнее": ["Сделай EMOM 12"]},
        "безопасность": ["Не форсируй темп, оставляй запас на технику"],
        "источник": "EMOM-финишер — отличный вариант «вписаться» даже в самый занятой день"
    },
    # =================== ПРОГРАММА НА НЕДЕЛЮ (4 шт) ===================
    {
        "тип": "программа_недели",
        "тема": "Программа на неделю №1 — Старт (подойдёт всем)",
        "для_кого": "Новичок/возвращение после паузы",
        "цель": "Привычка + техника + комфортная нагрузка",
        "как_начать": "Начни с Дня 1 в любой день недели. Дальше двигайся по порядку.",
        "общая_разминка": ["5 минут: ходьба/марш + суставная разминка"],
        "план": [
            "День 1: Тренировка дня №22 (EMOM 8) + 5 мин прогулка",
            "День 2: Восстановление (10–20 мин ходьба + растяжка)",
            "День 3: Тренировка дня №05 (TABATA низ 8 мин) или №07 (AMRAP без прыжков)",
            "День 4: Отдых/лёгкая мобильность 10 мин",
            "День 5: Тренировка дня №04 (HIIT 30/30, по самочувствию 14–20 мин)",
            "День 6: Восстановление (ходьба/растяжка)",
            "День 7: Тренировка дня №01 (TABATA full body, 8–12 мин)"
        ],
        "прогрессия": "Если всё ок — на следующей неделе добавь +1–2 минуты к длительным тренировкам или +1 блок табаты.",
        "безопасность": ["Боль — сигнал остановиться и упростить", "Сон и восстановление важнее героизма"]
    },
    {
        "тип": "программа_недели",
        "тема": "Программа на неделю №2 — Объём (ровный прогресс)",
        "для_кого": "Средний уровень",
        "цель": "Больше объёма без перегруза",
        "как_начать": "Начни с Дня 1 в любой день недели. Дни восстановления не пропускай.",
        "общая_разминка": ["5–7 минут: разогрев + мобилизация"],
        "план": [
            "День 1: Тренировка дня №10 (EMOM 14)",
            "День 2: Восстановление (ходьба 20–30 мин)",
            "День 3: Тренировка дня №15 (AMRAP 15)",
            "День 4: Отдых/мобилити 10–15 мин",
            "День 5: Тренировка дня №20 (HIIT круг 18 мин)",
            "День 6: Восстановление (растяжка/лёгкая активность)",
            "День 7: Тренировка дня №21 (TABATA 8 мин) + лёгкая прогулка"
        ],
        "прогрессия": "Добавляй 5–10% повторов или +1–2 минуты к AMRAP/HIIT каждую следующую неделю.",
        "безопасность": ["Не повышай объём, если техника «сыпется»", "Оставляй 1–2 повтора «в запасе»"]
    },
    {
        "тип": "программа_недели",
        "тема": "Программа на неделю №3 — Интенсивность (TABATA/HIIT)",
        "для_кого": "Средний/продвинутый",
        "цель": "Улучшить интервальную выносливость",
        "как_начать": "Стартуй с Дня 1 в любой день. Если тяжело — бери версии «проще» из тренировок.",
        "общая_разминка": ["7–10 минут: разогрев + 1 лёгкий круг упражнений"],
        "план": [
            "День 1: Тренировка дня №12 (HIIT 40/20, 12–16 мин)",
            "День 2: Восстановление (ходьба/мобилити)",
            "День 3: Тренировка дня №18 (TABATA пресс+кардио 8 мин)",
            "День 4: Отдых",
            "День 5: Тренировка дня №24 (HIIT 4×4)",
            "День 6: Восстановление",
            "День 7: Тренировка дня №29 (TABATA тест 4 мин) + заминка"
        ],
        "прогрессия": "Главное — качество интервалов. Усложняй только когда можешь держать технику весь блок.",
        "безопасность": ["Если есть проблемы с суставами — убери прыжки и берпи", "Не делай 2 «жёстких» дня подряд"]
    },
    {
        "тип": "программа_недели",
        "тема": "Программа на неделю №4 — Контроль и закрепление (лёгче, но умнее)",
        "для_кого": "Любой (делоад/закрепление)",
        "цель": "Восстановиться и закрепить привычку, не теряя форму",
        "как_начать": "Начни с Дня 1 в любой день. В конце недели сравни бенчмарк.",
        "общая_разминка": ["5–7 минут: спокойный разогрев"],
        "план": [
            "День 1: Тренировка дня №22 (EMOM 8) + прогулка",
            "День 2: Восстановление (растяжка 10–15 мин)",
            "День 3: Тренировка дня №07 (AMRAP без прыжков) или №11 (AMRAP 10)",
            "День 4: Отдых",
            "День 5: Тренировка дня №28 (HIIT 20/40, 10 мин)",
            "День 6: Восстановление",
            "День 7: Тренировка дня №27 (AMRAP бенчмарк 12 мин) — запиши результат"
        ],
        "прогрессия": "Цель недели — восстановиться: держи интенсивность на 7/10, не на 10/10.",
        "безопасность": ["Сон/вода/питание — часть программы", "Любая боль — упростить, а не терпеть"]
    },
]

# ------------------- АУДИТОРИЯ (мужчины/девушки) -------------------
# Исторически блоки «тренировка_дня» и «программа_недели» были универсальные.
# По запросу разделяем: текущий набор считаем «для мужчин», плюс добавляем отдельный для девушек.
for _тема in ТЕМЫ_КОНТЕНТА:
    if _тема.get("тип") in ("тренировка_дня", "программа_недели") and "аудитория" not in _тема:
        _тема["аудитория"] = "мужчины"

ТРЕНИРОВКИ_ДНЯ_ДЕВУШКИ = [
    {
        "тип": "тренировка_дня",
        "аудитория": "девушки",
        "тема": "Тренировка дня (девушки) №01 — TABATA Ягодицы/ноги (8 минут)",
        "формат": "TABATA",
        "уровень": "Новичок/Средний",
        "длительность": "8 минут",
        "оборудование": "Коврик",
        "цель": "Ягодицы + ноги + тонус без перегруза",
        "протокол": "2 блока табаты: 20/10 × 8 (по 4 минуты)",
        "разминка": ["4 мин: шаг + круги тазом + лёгкие приседания/выпады"],
        "тренировка": [
            {"блок": "Табата 1", "упражнение": "Ягодичный мост", "замена": "мост с паузой 1 сек", "подсказка": "толкайся пятками"},
            {"блок": "Табата 2", "упражнение": "Выпад назад (поочерёдно)", "замена": "меньше амплитуда", "подсказка": "корпус ровно"}
        ],
        "заминка": ["2–3 мин: растяжка ягодиц/бёдер"],
        "масштабирование": {"проще": ["Сократи до 1 блока"], "сложнее": ["Добавь 3-й блок: приседания"]},
        "безопасность": ["Колени в линию носков", "Поясницу в мосту не переразгибай"],
        "источник": "Протокол Табата: 20/10×8 (Tabata et al., 1996)"
    },
    {
        "тип": "тренировка_дня",
        "аудитория": "девушки",
        "тема": "Тренировка дня (девушки) №02 — EMOM 12 (корпус + осанка)",
        "формат": "EMOM",
        "уровень": "Любой",
        "длительность": "12 минут",
        "оборудование": "Коврик",
        "цель": "Корпус + осанка + спина",
        "протокол": "EMOM: задание в начале каждой минуты, остаток — отдых",
        "разминка": ["4 мин: кошка-корова + круги плечами + лёгкая планка"],
        "тренировка": [
            {"минута": "1,4,7,10", "задание": "10 приседаний", "проще": "8", "сложнее": "12"},
            {"минута": "2,5,8,11", "задание": "8 отжиманий от опоры/с колен", "проще": "6", "сложнее": "10"},
            {"минута": "3,6,9,12", "задание": "20 сек планка + 10 «супермен»", "проще": "планка с колен", "сложнее": "планка 30 сек"}
        ],
        "заминка": ["3 мин: растяжка грудных + поза ребёнка"],
        "масштабирование": {"проще": ["Уменьши повторы на 20%"], "сложнее": ["Добавь 2 минуты (EMOM 14)"]},
        "безопасность": ["Поясница в планке под контролем", "Шея расслаблена"],
        "источник": "EMOM — формат с удобной «встроенной» паузой для восстановления"
    },
    {
        "тип": "тренировка_дня",
        "аудитория": "девушки",
        "тема": "Тренировка дня (девушки) №03 — AMRAP 12 (без прыжков, стройный тонус)",
        "формат": "AMRAP",
        "уровень": "Новичок/Средний",
        "длительность": "12 минут",
        "оборудование": "Без оборудования",
        "цель": "Ровное кардио + тонус",
        "протокол": "AMRAP 12: максимум раундов в комфортном темпе",
        "разминка": ["4–5 мин: ходьба + мобилизация таза/голеностопа"],
        "тренировка": ["10 приседаний", "10 выпадов назад (в сумме)", "12 ягодичный мост", "20 шагов с коленями вверх"],
        "заминка": ["3 мин: растяжка бёдер/ягодиц"],
        "масштабирование": {"проще": ["Сделай 10 минут"], "сложнее": ["Добавь 20 сек планки после раунда"]},
        "безопасность": ["Не гони темп — держи технику", "Боль = упростить"],
        "источник": "AMRAP — удобный формат для прогресса без жёстких интервалов"
    },
    {
        "тип": "тренировка_дня",
        "аудитория": "девушки",
        "тема": "Тренировка дня (девушки) №04 — HIIT 16 минут (30/30, низкоударно)",
        "формат": "HIIT",
        "уровень": "Любой",
        "длительность": "16 минут",
        "оборудование": "Без оборудования",
        "цель": "Кардио без «убийства» суставов",
        "протокол": "8 раундов: 30 сек работа / 30 сек отдых (4 упражнения ×2 круга)",
        "разминка": ["5 мин: разогрев + суставная разминка"],
        "тренировка": [
            {"упражнение": "Шаг в стороны + руки вверх", "проще": "медленно", "сложнее": "быстрее"},
            {"упражнение": "Присед + подъём на носки", "проще": "полуприсед", "сложнее": "пульс 2 раза"},
            {"упражнение": "Планка", "проще": "с колен", "сложнее": "30 сек без провала"},
            {"упражнение": "Выпад назад", "проще": "меньше амплитуда", "сложнее": "выпад + колено вверх"}
        ],
        "заминка": ["3–4 мин: ходьба + дыхание", "2 мин: растяжка ног"],
        "масштабирование": {"проще": ["Сделай 12 минут"], "сложнее": ["Перейди на 40/20"]},
        "безопасность": ["Колени контролируй, без завала внутрь"],
        "источник": "HIIT можно делать низкоударно, сохраняя эффект интервалов"
    },
]

# Доводим до 30 тренировок дня для девушек (шаблонно — чтобы структура была одинаковая)
for i in range(5, 31):
    ТРЕНИРОВКИ_ДНЯ_ДЕВУШКИ.append({
        "тип": "тренировка_дня",
        "аудитория": "девушки",
        "тема": f"Тренировка дня (девушки) №{i:02d} — EMOM 10 (тонус + корпус)",
        "формат": "EMOM",
        "уровень": "Любой",
        "длительность": "10 минут",
        "оборудование": "Без оборудования",
        "цель": "Тонус всего тела + сильный корпус",
        "протокол": "EMOM 10: задание в начале каждой минуты, остаток — отдых",
        "разминка": ["4 мин: шаг + присед + лёгкая планка"],
        "тренировка": [
            {"минута": "нечётные", "задание": "12 приседаний", "проще": "10", "сложнее": "15"},
            {"минута": "чётные", "задание": "8 отжиманий (любой вариант) + 10 сек планка", "проще": "6 + 5 сек", "сложнее": "10 + 20 сек"}
        ],
        "заминка": ["3 мин: растяжка бёдер/груди"],
        "масштабирование": {"проще": ["Сократи повторения на 20%"], "сложнее": ["Добавь 2 минуты (EMOM 12)"]},
        "безопасность": ["Техника важнее темпа"],
        "источник": "EMOM — универсальный формат для любого уровня"
    })

ПРОГРАММЫ_НЕДЕЛИ_ДЕВУШКИ = [
    {
        "тип": "программа_недели",
        "аудитория": "девушки",
        "тема": "Программа на неделю (девушки) №1 — Старт + ягодицы/корпус",
        "для_кого": "Новичок/возвращение",
        "цель": "Привычка + тонус + техника",
        "как_начать": "Начни с Дня 1 в любой день. Дальше двигайся по порядку.",
        "общая_разминка": ["5–7 минут: ходьба/марш + суставная разминка"],
        "план": [
            "День 1: Тренировка дня (девушки) №01 (TABATA 8 мин)",
            "День 2: Восстановление (ходьба 20 мин + растяжка)",
            "День 3: Тренировка дня (девушки) №02 (EMOM 12)",
            "День 4: Отдых/мобилити 10–15 мин",
            "День 5: Тренировка дня (девушки) №04 (HIIT 16 мин, низкоударно)",
            "День 6: Восстановление",
            "День 7: Тренировка дня (девушки) №03 (AMRAP 12)"
        ],
        "прогрессия": "На следующей неделе увеличь объём на 5–10% (или +2 минуты к одной тренировке).",
        "безопасность": ["Любая боль — упростить", "Сон/восстановление — часть прогресса"]
    },
    {
        "тип": "программа_недели",
        "аудитория": "девушки",
        "тема": "Программа на неделю (девушки) №2 — Тонус (объём без перегруза)",
        "для_кого": "Средний уровень",
        "цель": "Больше объёма + стабильная техника",
        "как_начать": "Начни с Дня 1 в любой день недели.",
        "общая_разминка": ["7 минут: разогрев + мобилизация"],
        "план": [
            "День 1: Тренировка дня (девушки) №05 (EMOM 10)",
            "День 2: Восстановление",
            "День 3: Тренировка дня (девушки) №06 (EMOM 10)",
            "День 4: Отдых",
            "День 5: Тренировка дня (девушки) №07 (EMOM 10)",
            "День 6: Восстановление",
            "День 7: Тренировка дня (девушки) №08 (EMOM 10)"
        ],
        "прогрессия": "Каждую неделю добавляй +1–2 повтора в минуту или +2 минуты к EMOM.",
        "безопасность": ["Сохраняй контроль коленей и поясницы"]
    },
    {
        "тип": "программа_недели",
        "аудитория": "девушки",
        "тема": "Программа на неделю (девушки) №3 — Интервалы (HIIT/TABATA, но мягко)",
        "для_кого": "Средний уровень",
        "цель": "Интервальная выносливость без прыжкового «жёста»",
        "как_начать": "Начни с Дня 1 в любой день. Если тяжело — бери варианты «проще».",
        "общая_разминка": ["8–10 минут: разогрев + 1 лёгкий круг"],
        "план": [
            "День 1: Тренировка дня (девушки) №04 (HIIT 16 мин)",
            "День 2: Восстановление",
            "День 3: Тренировка дня (девушки) №01 (TABATA 8 мин)",
            "День 4: Отдых",
            "День 5: Тренировка дня (девушки) №09 (EMOM 10)",
            "День 6: Восстановление",
            "День 7: Тренировка дня (девушки) №10 (EMOM 10)"
        ],
        "прогрессия": "Усложняй только когда можешь держать технику весь интервал/минуту.",
        "безопасность": ["Не делай 2 тяжёлых дня подряд", "Прыжки — по желанию"]
    },
    {
        "тип": "программа_недели",
        "аудитория": "девушки",
        "тема": "Программа на неделю (девушки) №4 — Делоад и закрепление",
        "для_кого": "Любой",
        "цель": "Восстановиться и закрепить привычку",
        "как_начать": "Начни с Дня 1 в любой день недели.",
        "общая_разминка": ["5 минут: спокойный разогрев"],
        "план": [
            "День 1: Тренировка дня (девушки) №02 (EMOM 12)",
            "День 2: Восстановление",
            "День 3: Тренировка дня (девушки) №03 (AMRAP 12)",
            "День 4: Отдых",
            "День 5: Тренировка дня (девушки) №11 (EMOM 10)",
            "День 6: Восстановление",
            "День 7: Тренировка дня (девушки) №01 (TABATA 8 мин)"
        ],
        "прогрессия": "На этой неделе держи интенсивность 7/10, цель — восстановление.",
        "безопасность": ["Отдых важнее «добить» любой ценой"]
    }
]

ТЕМЫ_КОНТЕНТА.extend(ТРЕНИРОВКИ_ДНЯ_ДЕВУШКИ)
ТЕМЫ_КОНТЕНТА.extend(ПРОГРАММЫ_НЕДЕЛИ_ДЕВУШКИ)


def получить_фото_блюда(тема_рецепта):
    """Получает URL изображения блюда из словаря прямых ссылок"""
    try:
        # Ищем фото по названию темы
        if тема_рецепта in ФОТО_РЕЦЕПТОВ:
            url = ФОТО_РЕЦЕПТОВ[тема_рецепта]
            print(f"✅ Найдено фото для рецепта: {тема_рецепта}")
            return url
        else:
            # Если фото не найдено - используем случайное фитнес-фото
            print(f"⚠️ Фото для '{тема_рецепта}' не найдено, используем случайное")
            return random.choice(ФИТНЕС_ИЗОБРАЖЕНИЯ)
    except Exception as ошибка:
        print(f"❌ Ошибка получения фото: {str(ошибка)}")
        return random.choice(ФИТНЕС_ИЗОБРАЖЕНИЯ)


def сгенерировать_фитнес_пост(тема_данные):
    """
    Генерирует крутой современный пост про фитнес через DeepSeek API.
    Контент закрывает боли, написан разговорным языком, структурированный.
    
    Args:
        тема_данные (dict): Словарь с темой, болями, желаниями и результатами
    
    Returns:
        str: Сгенерированный текст поста
    """
    
    тип = тема_данные.get('тип')

    # Рецепты обрабатываем отдельной веткой
    if тип == 'рецепт':
        # Формируем структурированный промпт под подпись к фото (caption <= 1024 символов)
        промпт = f"""Ты - дружелюбный фитнес-кулинар: пишешь коротко, вкусно и по делу.

Сгенерируй подпись к фото для Telegram (до 900 символов), строго на русском.
Структура с эмодзи (именно в таком порядке, каждый блок с новой строки):
🍳 Название
⏱️ Время
🛒 Продукты (списком, как в данных — с ценами)
✅ Итого
📝 Способ (3–5 коротких шагов)
📊 Нутриенты
🔬 Польза (1–2 предложения + ссылка на исследование в скобках, например: Journal, 2015)
💡 Лайфхак (1 короткое предложение)

Правила:
- Не используй HTML/Markdown теги.
- Не добавляй хэштеги.
- Цены и формат продуктов оставь как в исходных данных.
- Не выдумывай новые ингредиенты: используй только то, что дано.

Данные рецепта (JSON):
{json.dumps(тема_данные, ensure_ascii=False, indent=2)}
"""
        системное = "Ты - помощник, который пишет короткие полезные фитнес-рецепты для Telegram с эмодзи и научной ссылкой."
        температура = 0.7
        макс_токены = 900
    elif тип == 'тренировка_дня':
        промпт = f"""Ты - тренер, который пишет короткие и понятные тренировки для Telegram.

Сгенерируй пост «Тренировка дня» (до 900 символов), строго на русском.
Структура с эмодзи (каждый блок с новой строки):
🏋️ Тренировка дня
🔥 Формат + цель
⏱️ Длительность + оборудование
🧊 Разминка (2–4 пункта)
✅ Тренировка (коротко, как в данных)
🧘 Заминка (1–3 пункта)
♻️ Масштабирование (проще/сложнее)
⚠️ Безопасность (1–2 пункта)

Правила:
- Не используй HTML/Markdown теги.
- Не добавляй хэштеги.
- Не выдумывай упражнений и блоков: используй только то, что есть в данных.
- Если в данных есть «источник» — упомяни его одной строкой в конце.

Данные тренировки (JSON):
{json.dumps(тема_данные, ensure_ascii=False, indent=2)}
"""
        системное = "Ты - аккуратный фитнес-тренер: понятно, безопасно, без лишней воды."
        температура = 0.6
        макс_токены = 900
    elif тип == 'программа_недели':
        промпт = f"""Ты - тренер и редактор Telegram-канала. Пиши кратко и максимально полезно.

Сгенерируй пост «Программа на неделю» (до 950 символов), строго на русском.
Важно: человек может начать в любой день — подчеркни это.

Структура с эмодзи:
📅 Программа недели
👤 Для кого + цель
✅ Как начать (стартуй с Дня 1 в любой день)
🧊 Разминка (общие правила)
🗓️ План (День 1–7 очень коротко)
📈 Прогрессия (как усложнять)
⚠️ Безопасность
💬 Призыв (1 строка)

Правила:
- Не используй HTML/Markdown теги.
- Не добавляй хэштеги.
- Не выдумывай тренировки вне данных: используй только то, что дано.

Данные программы (JSON):
{json.dumps(тема_данные, ensure_ascii=False, indent=2)}
"""
        системное = "Ты - тренер, который пишет недельные планы так, чтобы их мог начать любой человек в любой день."
        температура = 0.6
        макс_токены = 950
    else:
        # Формируем промпт для DeepSeek с учетом психологии оффера (мотивационные темы)
        промпт = f"""Ты - друг/подруга, который мотивирует заниматься фитнесом. Пиши просто и по-дружески, как в личной переписке.

Тема: {тема_данные['тема']}

БОЛИ аудитории (проговори их, чтобы человек узнал себя):
{тема_данные['боли']}

ЖЕЛАНИЯ (условия к результату - без стресса, легко, быстро):
{тема_данные['желания']}

РЕЗУЛЬТАТ (масштабные изменения в жизни):
{тема_данные['результат']}

Напиши короткий пост (до 600 символов) для Telegram с такой структурой:

1. ХУКА (2-3 предложения) - проговори боль разговорным языком, чтобы человек узнал себя. Используй "блин", "почему", "как же надоело".
2. РЕШЕНИЕ (2-3 предложения) - предложи простой способ без стресса.
3. РЕЗУЛЬТАТ (2-3 предложения) - покажи масштаб изменений во ВСЕЙ жизни, а не только в фитнесе.
4. ПРИЗЫВ (1 предложение) - мотивируй начать прямо сейчас.

Используй эмодзи 💪🔥⚡✨ для структурирования.
Пиши на "ты", как будто переписываешься с другом.
БЕЗ заголовков типа "Хука:", "Решение:". Просто текст с эмодзи.
"""
        системное = "Ты - мотивирующий фитнес-друг, который говорит просто и по делу. Закрываешь боли аудитории и мотивируешь."
        температура = 0.9
        макс_токены = 800
    
    try:
        # Отправляем запрос к DeepSeek API
        ответ = requests.post(
            "https://api.deepseek.com/v1/chat/completions",
            headers={
                "Authorization": f"Bearer {ДИПСИК_АПИ_КЛЮЧ}",
                "Content-Type": "application/json"
            },
            json={
                "model": "deepseek-chat",
                "messages": [
                    {"role": "system", "content": системное},
                    {"role": "user", "content": промпт}
                ],
                "temperature": температура,
                "max_tokens": макс_токены
            },
            timeout=30
        )
        
        if ответ.status_code == 200:
            данные = ответ.json()
            текст = данные['choices'][0]['message']['content'].strip()
            print(f"✅ Текст сгенерирован: {len(текст)} символов")
            return текст
        else:
            print(f"❌ Ошибка DeepSeek API: {ответ.status_code}")
            print(f"Ответ: {ответ.text}")
            return None
            
    except Exception as ошибка:
        print(f"❌ Исключение при генерации текста: {str(ошибка)}")
        return None


def отправить_в_телеграм(текст, фото_url):
    """
    Отправляет пост с фото и текстом в Telegram канал.
    
    Args:
        текст (str): Текст поста
        фото_url (str): URL изображения
    
    Returns:
        bool: True если успешно, False если ошибка
    """
    try:
        # Формируем URL для Telegram Bot API
        url = f"https://api.telegram.org/bot{ТЕЛЕГРАМ_БОТ_ТОКЕН}/sendPhoto"
        
        # Параметры запроса
        данные = {
            "chat_id": ТЕЛЕГРАМ_ЧАТ_ID,
            "photo": фото_url,
            "caption": текст,
            "parse_mode": "HTML"
        }
        
        # Отправляем POST запрос
        ответ = requests.post(url, data=данные, timeout=30)
        
        if ответ.status_code == 200:
            результат = ответ.json()
            message_id = результат['result']['message_id']
            print(f"✅ Пост отправлен в Telegram! Message ID: {message_id}")
            return True
        else:
            print(f"❌ Ошибка отправки в Telegram: {ответ.status_code}")
            print(f"Ответ: {ответ.text}")
            return False
            
    except Exception as ошибка:
        print(f"❌ Исключение при отправке в Telegram: {str(ошибка)}")
        return False


def главная():
    """
    Главная функция: генерирует и публикует пост в Telegram.
    """
    print("🚀 Запуск FITNESS TIMER Автопостинга...")
    print(f"⏰ Время: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    
    # Проверяем наличие токенов
    if not ДИПСИК_АПИ_КЛЮЧ or not ТЕЛЕГРАМ_БОТ_ТОКЕН or not ТЕЛЕГРАМ_ЧАТ_ID:
        print("❌ Ошибка: Не установлены переменные окружения!")
        print("Проверьте: DEEPSEEK_API_KEY, TELEGRAM_BOT_TOKEN, TELEGRAM_CHAT_ID")
        return False
    
    # Выбираем аудиторию поста (можно управлять переменной окружения FITNESS_AUDIENCE)
    # Допустимые значения: мужчины / девушки / любая (по умолчанию публикуем вперемешку)
    аудитория_env = (os.getenv("FITNESS_AUDIENCE", "") or "").strip().lower()
    if аудитория_env in ("м", "муж", "мужчины", "men"):
        аудитория = "мужчины"
    elif аудитория_env in ("ж", "д", "дев", "девушки", "жен", "женщины", "women"):
        аудитория = "девушки"
    else:
        аудитория = None  # любая

    # Выбираем случайную тему для разнообразия (с учётом аудитории)
    кандидаты = []
    for т in ТЕМЫ_КОНТЕНТА:
        аудитория_темы = т.get("аудитория")
        if аудитория is None:
            кандидаты.append(т)  # публикуем всё: мужчины/девушки/универсальное
        else:
            if аудитория_темы is None or аудитория_темы == аудитория:
                кандидаты.append(т)
    тема = random.choice(кандидаты) if кандидаты else random.choice(ТЕМЫ_КОНТЕНТА)
    print(f"📌 Выбрана тема: {тема['тема']}")
    
    # Генерируем текст через DeepSeek
    print("🤖 Генерируем текст через DeepSeek AI...")
    текст = сгенерировать_фитнес_пост(тема)
    
    if not текст:
        print("❌ Не удалось сгенерировать текст")
        return False
    
    # Выбираем изображение: для рецептов — по запросу, для тренировок — из списка фитнес-фото
    if тема.get('тип') == 'рецепт':
        название_рецепта = тема.get('тема')
        фото_url = получить_фото_блюда(название_рецепта)
        print(f"🖼️ Фото для рецепта: {название_рецепта}")
    else:
        фото_url = random.choice(ФИТНЕС_ИЗОБРАЖЕНИЯ)
    print(f"🖼️ Выбрано изображение: {фото_url[:50]}...")
    
    # Отправляем в Telegram
    print("📤 Отправляем пост в Telegram канал @fitnesstimer...")
    успех = отправить_в_телеграм(текст, фото_url)
    
    if успех:
        print("\n" + "="*50)
        print("🎉 АВТОПОСТИНГ ЗАВЕРШЁН УСПЕШНО!")
        print("="*50)
        return True
    else:
        print("\n" + "="*50)
        print("❌ АВТОПОСТИНГ ЗАВЕРШЁН С ОШИБКОЙ")
        print("="*50)
        return False


if __name__ == "__main__":
    главная()
