name: üîç SEO-–∞—É–¥–∏—Ç —Å–∞–π—Ç–∞

on:
  schedule:
    # –ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é –≤ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 08:00 –ú–°–ö (05:00 UTC)
    - cron: '0 5 * * 1'
  workflow_dispatch:
    inputs:
      url:
        description: 'URL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏'
        required: false
        default: 'https://tabatatimer.ru'

jobs:
  lighthouse:
    name: Lighthouse SEO Audit
    runs-on: ubuntu-latest
    
    steps:
      - name: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
        uses: actions/checkout@v4
      
      - name: –ó–∞–ø—É—Å–∫ Lighthouse CI
        uses: treosh/lighthouse-ci-action@v10
        with:
          urls: |
            https://tabatatimer.ru
            https://tabatatimer.ru/#timer
          uploadArtifacts: true
          temporaryPublicStorage: true
      
      - name: –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–∞ –≤ Telegram
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: |
          python3 << 'PYTHON'
          import os
          import requests
          import json
          from pathlib import Path
          
          BOT_TOKEN = os.getenv('TELEGRAM_BOT_TOKEN')
          CHAT_ID = os.getenv('TELEGRAM_CHAT_ID')
          
          # –ò—â–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã Lighthouse
          results_path = Path('.lighthouseci')
          if results_path.exists():
              report = """
          üîç **SEO-–∞—É–¥–∏—Ç —Å–∞–π—Ç–∞ tabatatimer.ru**
          
          ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
          
          üìä –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
          - Performance: [–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –æ—Ç—á—ë—Ç–∞]
          - Accessibility: [–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –æ—Ç—á—ë—Ç–∞]
          - Best Practices: [–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –æ—Ç—á—ë—Ç–∞]
          - SEO: [–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –æ—Ç—á—ë—Ç–∞]
          
          üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
          - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
          - –£–ª—É—á—à–∏—Ç—å –º–µ—Ç–∞-—Ç–µ–≥–∏
          - –£—Å–∫–æ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü
          
          üìé –ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç: [—Å—Å—ã–ª–∫–∞ –Ω–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç]
          """
              
              send_url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendMessage"
              send_params = {
                  "chat_id": CHAT_ID,
                  "text": report,
                  "parse_mode": "Markdown"
              }
              requests.post(send_url, json=send_params)
              print("‚úÖ SEO-–æ—Ç—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!")
          else:
              print("‚ö†Ô∏è –û—Ç—á—ë—Ç Lighthouse –Ω–µ –Ω–∞–π–¥–µ–Ω")
          PYTHON

