#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
    –ú–æ–¥—É–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ —Ç–µ–º–∞—Ç–∏–∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–π
    
    –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
    –∏ –≤—ã–±–∏—Ä–∞—è —Å—Ç–∞—Ç—å–∏ —Å –Ω–∞–∏–º–µ–Ω–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —Ç–µ–º–∞—Ç–∏–∫–∞–º–∏.
    
    –ê–≤—Ç–æ—Ä: VR-Lounge
"""

import json
from pathlib import Path
from typing import List, Dict, Tuple, Optional
from collections import Counter
from datetime import datetime, timedelta

# –ü—É—Ç—å –∫ blog-posts.json
BLOG_POSTS_FILE = Path('public_html/blog-posts.json')

# –¶–µ–ª–µ–≤–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–º–∞—Ç–∏–∫ (–≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö)
TARGET_TOPIC_DISTRIBUTION = {
    '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞': 40,
    '–ü–∏—Ç–∞–Ω–∏–µ': 30,
    '–î–∏–µ—Ç—ã': 15,
    '–ú–æ—Ç–∏–≤–∞—Ü–∏—è': 15
}

# –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ç–µ–º–∞—Ç–∏–∫ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫ (UTC)
TIME_PRIORITIES = {
    '08': ['–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞', '–ú–æ—Ç–∏–≤–∞—Ü–∏—è'],  # –£—Ç—Ä–æ - —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è
    '10': ['–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞', '–ü–∏—Ç–∞–Ω–∏–µ'],   # –î–µ–Ω—å - —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ –ø–∏—Ç–∞–Ω–∏–µ
    '12': ['–ü–∏—Ç–∞–Ω–∏–µ', '–î–∏–µ—Ç—ã'],        # –î–µ–Ω—å - –ø–∏—Ç–∞–Ω–∏–µ –∏ –¥–∏–µ—Ç—ã
    '14': ['–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞', '–ü–∏—Ç–∞–Ω–∏–µ'],   # –î–µ–Ω—å - —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ –ø–∏—Ç–∞–Ω–∏–µ
    '18': ['–ú–æ—Ç–∏–≤–∞—Ü–∏—è', '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞'], # –í–µ—á–µ—Ä - –º–æ—Ç–∏–≤–∞—Ü–∏—è –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
    '20': ['–î–∏–µ—Ç—ã', '–ü–∏—Ç–∞–Ω–∏–µ']         # –ü–æ–∑–¥–Ω–∏–π –≤–µ—á–µ—Ä - –¥–∏–µ—Ç—ã –∏ –ø–∏—Ç–∞–Ω–∏–µ
}

def –ø–æ–ª—É—á–∏—Ç—å_–ø–æ—Å–ª–µ–¥–Ω–∏–µ_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏(n: int = 10) -> List[Dict]:
    """
    –ü–æ–ª—É—á–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ –∏–∑ blog-posts.json
    
    Args:
        n: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ—Å—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    
    Returns:
        –°–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ—Å—Ç–æ–≤ —Å –∏—Ö —Ç–µ–≥–∞–º–∏
    """
    if not BLOG_POSTS_FILE.exists():
        return []
    
    try:
        with open(BLOG_POSTS_FILE, 'r', encoding='utf-8') as f:
            data = json.load(f)
            posts = data.get('posts', [])
            # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –ø–æ—Å—Ç–æ–≤ (–æ–Ω–∏ –≤ –Ω–∞—á–∞–ª–µ —Å–ø–∏—Å–∫–∞)
            return posts[:n]
    except Exception as e:
        print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è blog-posts.json: {e}")
        return []

def –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å_—Ç–µ–º—ã_–ø–æ—Å–ª–µ–¥–Ω–∏—Ö_–ø—É–±–ª–∏–∫–∞—Ü–∏–π(n: int = 10) -> Dict[str, int]:
    """
    –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É —Ç–µ–º–∞—Ç–∏–∫ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N –ø—É–±–ª–∏–∫–∞—Ü–∏—è—Ö
    
    Args:
        n: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ—Å—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    
    Returns:
        –°–ª–æ–≤–∞—Ä—å {—Ç–µ–º–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø—É–±–ª–∏–∫–∞—Ü–∏–π}
    """
    –ø–æ—Å–ª–µ–¥–Ω–∏–µ_–ø–æ—Å—Ç—ã = –ø–æ–ª—É—á–∏—Ç—å_–ø–æ—Å–ª–µ–¥–Ω–∏–µ_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏(n)
    
    –≤—Å–µ_—Ç–µ–≥–∏ = []
    for –ø–æ—Å—Ç in –ø–æ—Å–ª–µ–¥–Ω–∏–µ_–ø–æ—Å—Ç—ã:
        —Ç–µ–≥–∏ = –ø–æ—Å—Ç.get('tags', [])
        # –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ–≥–∏ (–∏—Å–∫–ª—é—á–∞–µ–º "–î–µ–≤—É—à–∫–∞–º"/"–ú—É–∂—á–∏–Ω–∞–º")
        —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ_—Ç–µ–≥–∏ = [—Ç for —Ç in —Ç–µ–≥–∏ if —Ç not in ['–î–µ–≤—É—à–∫–∞–º', '–ú—É–∂—á–∏–Ω–∞–º']]
        –≤—Å–µ_—Ç–µ–≥–∏.extend(—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ_—Ç–µ–≥–∏)
    
    return dict(Counter(–≤—Å–µ_—Ç–µ–≥–∏))

def –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å_–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç_—Ç–µ–º—ã_–ø–æ_–≤—Ä–µ–º–µ–Ω–∏(—Ç–µ–º–∞: str, —Ç–µ–∫—É—â–∏–π_—á–∞—Å_utc: str) -> int:
    """
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ç–µ–º—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
    
    Args:
        —Ç–µ–º–∞: –¢–µ–º–∞—Ç–∏–∫–∞ —Å—Ç–∞—Ç—å–∏ (–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞, –ü–∏—Ç–∞–Ω–∏–µ, –î–∏–µ—Ç—ã, –ú–æ—Ç–∏–≤–∞—Ü–∏—è)
        —Ç–µ–∫—É—â–∏–π_—á–∞—Å_utc: –¢–µ–∫—É—â–∏–π —á–∞—Å –≤ UTC (—Å—Ç—Ä–æ–∫–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä "08", "14")
    
    Returns:
        –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç (0-100, –≥–¥–µ 100 - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
    """
    –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã_—Ç–µ–º = TIME_PRIORITIES.get(—Ç–µ–∫—É—â–∏–π_—á–∞—Å_utc, [])
    
    if —Ç–µ–º–∞ in –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã_—Ç–µ–º:
        # –ï—Å–ª–∏ —Ç–µ–º–∞ –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞—Ö –¥–ª—è —ç—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ - –≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
        –∏–Ω–¥–µ–∫—Å = –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã_—Ç–µ–º.index(—Ç–µ–º–∞)
        return 100 - (–∏–Ω–¥–µ–∫—Å * 10)  # –ü–µ—Ä–≤–∞—è —Ç–µ–º–∞ = 100, –≤—Ç–æ—Ä–∞—è = 90
    else:
        # –ï—Å–ª–∏ —Ç–µ–º–∞ –Ω–µ –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞—Ö - —Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
        return 50

def —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å_–±–∞–ª–ª_–±–∞–ª–∞–Ω—Å–∞(—Ç–µ–º–∞: str, –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ_—Ç–µ–º—ã: Dict[str, int], 
                            —Ç–µ–∫—É—â–∏–π_—á–∞—Å_utc: str, n_–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö: int = 10) -> float:
    """
    –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –±–∞–ª–ª –±–∞–ª–∞–Ω—Å–∞ –¥–ª—è —Ç–µ–º—ã —Å—Ç–∞—Ç—å–∏
    
    –ß–µ–º –º–µ–Ω—å—à–µ —Ç–µ–º–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏—è—Ö,
    —Ç–µ–º –≤—ã—à–µ –±–∞–ª–ª (—Å—Ç–∞—Ç—å—è –±–æ–ª–µ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–∞ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏).
    
    Args:
        —Ç–µ–º–∞: –¢–µ–º–∞—Ç–∏–∫–∞ —Å—Ç–∞—Ç—å–∏
        –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ_—Ç–µ–º—ã: –°–ª–æ–≤–∞—Ä—å {—Ç–µ–º–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ} –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π
        —Ç–µ–∫—É—â–∏–π_—á–∞—Å_utc: –¢–µ–∫—É—â–∏–π —á–∞—Å –≤ UTC
        n_–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ—Å—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    
    Returns:
        –ë–∞–ª–ª –±–∞–ª–∞–Ω—Å–∞ (0-200, –≥–¥–µ –≤—ã—à–µ = –ª—É—á—à–µ)
    """
    # –ë–∞–∑–æ–≤—ã–π –±–∞–ª–ª (–µ—Å–ª–∏ —Ç–µ–º–∞ –≤–æ–æ–±—â–µ –Ω–µ –ø—É–±–ª–∏–∫–æ–≤–∞–ª–∞—Å—å - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª)
    –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø—É–±–ª–∏–∫–∞—Ü–∏–π_—Ç–µ–º—ã = –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ_—Ç–µ–º—ã.get(—Ç–µ–º–∞, 0)
    
    # –ß–µ–º –º–µ–Ω—å—à–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–π —Ç–µ–º—ã, —Ç–µ–º –≤—ã—à–µ –±–∞–ª–ª
    # –ï—Å–ª–∏ —Ç–µ–º–∞ –Ω–µ –ø—É–±–ª–∏–∫–æ–≤–∞–ª–∞—Å—å - –±–∞–ª–ª = 100
    # –ï—Å–ª–∏ –ø—É–±–ª–∏–∫–æ–≤–∞–ª–∞—Å—å 5 —Ä–∞–∑ –∏–∑ 10 - –±–∞–ª–ª = 50
    # –ï—Å–ª–∏ –ø—É–±–ª–∏–∫–æ–≤–∞–ª–∞—Å—å 10 —Ä–∞–∑ –∏–∑ 10 - –±–∞–ª–ª = 0
    –±–∞–∑–æ–≤—ã–π_–±–∞–ª–ª = max(0, 100 - (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø—É–±–ª–∏–∫–∞—Ü–∏–π_—Ç–µ–º—ã * 10))
    
    # –ë–æ–Ω—É—Å –∑–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
    –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç_–ø–æ_–≤—Ä–µ–º–µ–Ω–∏ = –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å_–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç_—Ç–µ–º—ã_–ø–æ_–≤—Ä–µ–º–µ–Ω–∏(—Ç–µ–º–∞, —Ç–µ–∫—É—â–∏–π_—á–∞—Å_utc)
    
    # –ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª = –±–∞–∑–æ–≤—ã–π –±–∞–ª–ª + –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–∏
    –∏—Ç–æ–≥–æ–≤—ã–π_–±–∞–ª–ª = –±–∞–∑–æ–≤—ã–π_–±–∞–ª–ª + (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç_–ø–æ_–≤—Ä–µ–º–µ–Ω–∏ / 2)
    
    return –∏—Ç–æ–≥–æ–≤—ã–π_–±–∞–ª–ª

def –≤—ã–±—Ä–∞—Ç—å_—Å—Ç–∞—Ç—å—é_–¥–ª—è_–±–∞–ª–∞–Ω—Å–∞(—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ_—Å—Ç–∞—Ç—å–∏: List[Dict], 
                                —Ç–µ–∫—É—â–∏–π_—á–∞—Å_utc: str = None,
                                n_–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö: int = 10) -> Optional[Dict]:
    """
    –í—ã–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç—å—é —Å –Ω–∞–∏–ª—É—á—à–∏–º –±–∞–ª–∞–Ω—Å–æ–º —Ç–µ–º–∞—Ç–∏–∫ –∏–∑ —Å–ø–∏—Å–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö
    
    Args:
        —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ_—Å—Ç–∞—Ç—å–∏: –°–ø–∏—Å–æ–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π –∏–∑ RSS
        —Ç–µ–∫—É—â–∏–π_—á–∞—Å_utc: –¢–µ–∫—É—â–∏–π —á–∞—Å –≤ UTC (–µ—Å–ª–∏ None, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
        n_–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ—Å—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±–∞–ª–∞–Ω—Å–∞
    
    Returns:
        –°—Ç–∞—Ç—å—è —Å –Ω–∞–∏–ª—É—á—à–∏–º –±–∞–ª–∞–Ω—Å–æ–º –∏–ª–∏ None, –µ—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç
    """
    if not —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ_—Å—Ç–∞—Ç—å–∏:
        return None
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —á–∞—Å UTC
    if —Ç–µ–∫—É—â–∏–π_—á–∞—Å_utc is None:
        —Ç–µ–∫—É—â–∏–π_—á–∞—Å_utc = datetime.utcnow().strftime('%H')
    
    # –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π
    –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ_—Ç–µ–º—ã = –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å_—Ç–µ–º—ã_–ø–æ—Å–ª–µ–¥–Ω–∏—Ö_–ø—É–±–ª–∏–∫–∞—Ü–∏–π(n_–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö)
    
    print(f"\nüìä –ê–Ω–∞–ª–∏–∑ –±–∞–ª–∞–Ω—Å–∞ —Ç–µ–º–∞—Ç–∏–∫ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ {n_–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö} –ø—É–±–ª–∏–∫–∞—Ü–∏–π):")
    for —Ç–µ–º–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ in –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ_—Ç–µ–º—ã.items():
        –ø—Ä–æ—Ü–µ–Ω—Ç = (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ / n_–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö) * 100
        print(f"   {—Ç–µ–º–∞}: {–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ} –ø—É–±–ª–∏–∫–∞—Ü–∏–π ({–ø—Ä–æ—Ü–µ–Ω—Ç:.1f}%)")
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–º–∞—Ç–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π —Å—Ç–∞—Ç—å–∏ (–±—ã—Å—Ç—Ä–æ, –±–µ–∑ DeepSeek)
    —Å—Ç–∞—Ç—å–∏_—Å_–±–∞–ª–ª–∞–º–∏ = []
    
    for —Å—Ç–∞—Ç—å—è in —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ_—Å—Ç–∞—Ç—å–∏[:20]:  # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–æ 20 —Å—Ç–∞—Ç–µ–π
        # –ë—ã—Å—Ç—Ä–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–≥–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ title –∏ description
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É (–±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞)
        —Ç–µ–∫—Å—Ç_–¥–ª—è_–∞–Ω–∞–ª–∏–∑–∞ = (—Å—Ç–∞—Ç—å—è.get('title', '') + ' ' + 
                           —Å—Ç–∞—Ç—å—è.get('description', '')).lower()
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ç–µ–º–∞—Ç–∏–∫—É (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        –æ—Å–Ω–æ–≤–Ω–∞—è_—Ç–µ–º–∞ = None
        —Ç–µ–º—ã_–±–∞–ª–ª—ã = {}
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –≤–æ–∑–º–æ–∂–Ω—É—é —Ç–µ–º—É
        –≤–æ–∑–º–æ–∂–Ω—ã–µ_—Ç–µ–º—ã = ['–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞', '–ü–∏—Ç–∞–Ω–∏–µ', '–î–∏–µ—Ç—ã', '–ú–æ—Ç–∏–≤–∞—Ü–∏—è']
        
        for —Ç–µ–º–∞ in –≤–æ–∑–º–æ–∂–Ω—ã–µ_—Ç–µ–º—ã:
            # –£–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
            –º–∞—Ä–∫–µ—Ä—ã = {
                '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞': ['—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫', '—É–ø—Ä–∞–∂–Ω–µ–Ω', 'workout', 'exercise', 'training', 'tabata', 'hiit'],
                '–ü–∏—Ç–∞–Ω–∏–µ': ['–ø–∏—Ç–∞–Ω–∏', '—Ä–µ—Ü–µ–ø—Ç', '–µ–¥–∞', 'nutrition', 'meal', 'food', 'protein'],
                '–î–∏–µ—Ç—ã': ['–¥–∏–µ—Ç', '–ø–æ—Ö—É–¥–µ–Ω', '–∫–∞–ª–æ—Ä–∏', 'diet', 'weight loss', 'calorie'],
                '–ú–æ—Ç–∏–≤–∞—Ü–∏—è': ['–º–æ—Ç–∏–≤–∞—Ü', '–≤–¥–æ—Ö–Ω–æ–≤', '—Ä–µ–∑—É–ª—å—Ç–∞—Ç', '—Ü–µ–ª—å', 'motivation', 'inspiration']
            }
            
            —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è = sum(1 for –º–∞—Ä–∫–µ—Ä in –º–∞—Ä–∫–µ—Ä—ã.get(—Ç–µ–º–∞, []) 
                           if –º–∞—Ä–∫–µ—Ä in —Ç–µ–∫—Å—Ç_–¥–ª—è_–∞–Ω–∞–ª–∏–∑–∞)
            
            if —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è > 0:
                —Ç–µ–º—ã_–±–∞–ª–ª—ã[—Ç–µ–º–∞] = —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
        
        # –í—ã–±–∏—Ä–∞–µ–º —Ç–µ–º—É —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
        if —Ç–µ–º—ã_–±–∞–ª–ª—ã:
            –æ—Å–Ω–æ–≤–Ω–∞—è_—Ç–µ–º–∞ = max(—Ç–µ–º—ã_–±–∞–ª–ª—ã.items(), key=lambda x: x[1])[0]
        
        # –ï—Å–ª–∏ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ —Ç–µ–º—É, –∏—Å–ø–æ–ª—å–∑—É–µ–º "–ú–æ—Ç–∏–≤–∞—Ü–∏—è" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        if not –æ—Å–Ω–æ–≤–Ω–∞—è_—Ç–µ–º–∞:
            –æ—Å–Ω–æ–≤–Ω–∞—è_—Ç–µ–º–∞ = '–ú–æ—Ç–∏–≤–∞—Ü–∏—è'
        
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –±–∞–ª–ª –±–∞–ª–∞–Ω—Å–∞
        –±–∞–ª–ª = —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å_–±–∞–ª–ª_–±–∞–ª–∞–Ω—Å–∞(–æ—Å–Ω–æ–≤–Ω–∞—è_—Ç–µ–º–∞, –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ_—Ç–µ–º—ã, 
                                       —Ç–µ–∫—É—â–∏–π_—á–∞—Å_utc, n_–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö)
        
        —Å—Ç–∞—Ç—å–∏_—Å_–±–∞–ª–ª–∞–º–∏.append({
            '—Å—Ç–∞—Ç—å—è': —Å—Ç–∞—Ç—å—è,
            '—Ç–µ–º–∞': –æ—Å–Ω–æ–≤–Ω–∞—è_—Ç–µ–º–∞,
            '–±–∞–ª–ª': –±–∞–ª–ª
        })
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –±–∞–ª–ª—É (–≤—ã—à–µ = –ª—É—á—à–µ)
    —Å—Ç–∞—Ç—å–∏_—Å_–±–∞–ª–ª–∞–º–∏.sort(key=lambda x: x['–±–∞–ª–ª'], reverse=True)
    
    # –í—ã–≤–æ–¥–∏–º —Ç–æ–ø-5 –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
    print(f"\nüèÜ –¢–æ–ø-5 —Å—Ç–∞—Ç–µ–π –ø–æ –±–∞–ª–∞–Ω—Å—É —Ç–µ–º–∞—Ç–∏–∫:")
    for i, item in enumerate(—Å—Ç–∞—Ç—å–∏_—Å_–±–∞–ª–ª–∞–º–∏[:5], 1):
        –∑–∞–≥–æ–ª–æ–≤–æ–∫ = item['—Å—Ç–∞—Ç—å—è'].get('title', '')[:60]
        print(f"   {i}. [{item['—Ç–µ–º–∞']}] –ë–∞–ª–ª: {item['–±–∞–ª–ª']:.1f} - {–∑–∞–≥–æ–ª–æ–≤–æ–∫}...")
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞—Ç—å—é —Å –Ω–∞–∏–≤—ã—Å—à–∏–º –±–∞–ª–ª–æ–º
    if —Å—Ç–∞—Ç—å–∏_—Å_–±–∞–ª–ª–∞–º–∏:
        –ª—É—á—à–∞—è = —Å—Ç–∞—Ç—å–∏_—Å_–±–∞–ª–ª–∞–º–∏[0]
        print(f"\n‚úÖ –í—ã–±—Ä–∞–Ω–∞ —Å—Ç–∞—Ç—å—è: [{–ª—É—á—à–∞—è['—Ç–µ–º–∞']}] –ë–∞–ª–ª: {–ª—É—á—à–∞—è['–±–∞–ª–ª']:.1f}")
        return –ª—É—á—à–∞—è['—Å—Ç–∞—Ç—å—è']
    
    return None

def –ø–æ–ª—É—á–∏—Ç—å_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É_–±–∞–ª–∞–Ω—Å–∞_–∑–∞_–ø–µ—Ä–∏–æ–¥(–¥–Ω–µ–π: int = 7) -> Dict:
    """
    –ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –±–∞–ª–∞–Ω—Å–∞ —Ç–µ–º–∞—Ç–∏–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π
    
    Args:
        –¥–Ω–µ–π: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    
    Returns:
        –°–ª–æ–≤–∞—Ä—å —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
    """
    if not BLOG_POSTS_FILE.exists():
        return {}
    
    try:
        with open(BLOG_POSTS_FILE, 'r', encoding='utf-8') as f:
            data = json.load(f)
            posts = data.get('posts', [])
        
        # –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ—Å—Ç—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π
        —Å–µ–π—á–∞—Å = datetime.now()
        –≥—Ä–∞–Ω–∏—Ü–∞ = —Å–µ–π—á–∞—Å - timedelta(days=–¥–Ω–µ–π)
        
        –ø–æ—Å—Ç—ã_–∑–∞_–ø–µ—Ä–∏–æ–¥ = []
        for –ø–æ—Å—Ç in posts:
            try:
                –¥–∞—Ç–∞_–ø–æ—Å—Ç–∞ = datetime.fromisoformat(–ø–æ—Å—Ç.get('date', '').replace('Z', '+00:00'))
                if –¥–∞—Ç–∞_–ø–æ—Å—Ç–∞ >= –≥—Ä–∞–Ω–∏—Ü–∞:
                    –ø–æ—Å—Ç—ã_–∑–∞_–ø–µ—Ä–∏–æ–¥.append(–ø–æ—Å—Ç)
            except:
                continue
        
        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Ç–µ–º–∞—Ç–∏–∫–∏
        –≤—Å–µ_—Ç–µ–≥–∏ = []
        for –ø–æ—Å—Ç in –ø–æ—Å—Ç—ã_–∑–∞_–ø–µ—Ä–∏–æ–¥:
            —Ç–µ–≥–∏ = –ø–æ—Å—Ç.get('tags', [])
            —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ_—Ç–µ–≥–∏ = [—Ç for —Ç in —Ç–µ–≥–∏ if —Ç not in ['–î–µ–≤—É—à–∫–∞–º', '–ú—É–∂—á–∏–Ω–∞–º']]
            –≤—Å–µ_—Ç–µ–≥–∏.extend(—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ_—Ç–µ–≥–∏)
        
        —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞_—Ç–µ–º = dict(Counter(–≤—Å–µ_—Ç–µ–≥–∏))
        –≤—Å–µ–≥–æ_–ø—É–±–ª–∏–∫–∞—Ü–∏–π = len(–ø–æ—Å—Ç—ã_–∑–∞_–ø–µ—Ä–∏–æ–¥)
        
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã
        –ø—Ä–æ—Ü–µ–Ω—Ç—ã = {}
        for —Ç–µ–º–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ in —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞_—Ç–µ–º.items():
            –ø—Ä–æ—Ü–µ–Ω—Ç—ã[—Ç–µ–º–∞] = (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ / –≤—Å–µ–≥–æ_–ø—É–±–ª–∏–∫–∞—Ü–∏–π * 100) if –≤—Å–µ–≥–æ_–ø—É–±–ª–∏–∫–∞—Ü–∏–π > 0 else 0
        
        return {
            '–ø–µ—Ä–∏–æ–¥_–¥–Ω–µ–π': –¥–Ω–µ–π,
            '–≤—Å–µ–≥–æ_–ø—É–±–ª–∏–∫–∞—Ü–∏–π': –≤—Å–µ–≥–æ_–ø—É–±–ª–∏–∫–∞—Ü–∏–π,
            '—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞_—Ç–µ–º': —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞_—Ç–µ–º,
            '–ø—Ä–æ—Ü–µ–Ω—Ç—ã': –ø—Ä–æ—Ü–µ–Ω—Ç—ã,
            '—Ü–µ–ª–µ–≤–æ–µ_—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ': TARGET_TOPIC_DISTRIBUTION
        }
    except Exception as e:
        print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: {e}")
        return {}
