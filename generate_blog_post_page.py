#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
    –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä HTML —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è —Å—Ç–∞—Ç–µ–π –±–ª–æ–≥–∞
    
    –°–æ–∑–¥–∞—ë—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç–∞—Ç—å–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏
    –º–µ—Ç–∞-—Ç–µ–≥–∞–º–∏, Open Graph, Schema.org –¥–ª—è SEO –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏.
    
    –ê–≤—Ç–æ—Ä: VR-Lounge
"""

import json
import re
from pathlib import Path
from datetime import datetime
from urllib.parse import quote

# –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –ø–æ—Å—Ç–∞–º–∏
# –í GitHub Actions —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫–ª–æ–Ω–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ—Ä–µ–Ω—å, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å
SCRIPT_DIR = Path(__file__).parent.absolute()
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≥–¥–µ –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è
if (SCRIPT_DIR.parent / 'public_html').exists():
    # –ú—ã –≤ fitness-timer-autopost, public_html –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ
    REPO_ROOT = SCRIPT_DIR.parent
elif (SCRIPT_DIR / 'public_html').exists():
    # –ú—ã –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
    REPO_ROOT = SCRIPT_DIR
else:
    # –ü—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ public_html –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    REPO_ROOT = Path.cwd()
    if not (REPO_ROOT / 'public_html').exists():
        # –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ - –∏—â–µ–º –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        REPO_ROOT = REPO_ROOT.parent

BLOG_POSTS_FILE = REPO_ROOT / 'public_html' / 'blog-posts.json'
BLOG_POSTS_DIR = REPO_ROOT / 'public_html' / 'blog'
BLOG_POSTS_DIR.mkdir(parents=True, exist_ok=True)

def –æ—á–∏—Å—Ç–∏—Ç—å_—Ç–µ–∫—Å—Ç_–æ—Ç_html(—Ç–µ–∫—Å—Ç):
    """–û—á–∏—â–∞–µ—Ç —Ç–µ–∫—Å—Ç –æ—Ç HTML —Ç–µ–≥–æ–≤ –¥–ª—è –º–µ—Ç–∞-–æ–ø–∏—Å–∞–Ω–∏—è"""
    if not —Ç–µ–∫—Å—Ç:
        return ''
    # –£–±–∏—Ä–∞–µ–º HTML —Ç–µ–≥–∏
    —Ç–µ–∫—Å—Ç = re.sub(r'<[^>]+>', '', —Ç–µ–∫—Å—Ç)
    # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
    —Ç–µ–∫—Å—Ç = ' '.join(—Ç–µ–∫—Å—Ç.split())
    return —Ç–µ–∫—Å—Ç

def —Å–æ–∑–¥–∞—Ç—å_slug(—Ç–µ–∫—Å—Ç, post_id):
    """–°–æ–∑–¥–∞—ë—Ç URL-friendly slug –∏–∑ —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ID"""
    if not —Ç–µ–∫—Å—Ç:
        return post_id
    
    # –¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞
    —Ç—Ä–∞–Ω—Å–ª–∏—Ç = {
        '–∞': 'a', '–±': 'b', '–≤': 'v', '–≥': 'g', '–¥': 'd', '–µ': 'e', '—ë': 'yo',
        '–∂': 'zh', '–∑': 'z', '–∏': 'i', '–π': 'y', '–∫': 'k', '–ª': 'l', '–º': 'm',
        '–Ω': 'n', '–æ': 'o', '–ø': 'p', '—Ä': 'r', '—Å': 's', '—Ç': 't', '—É': 'u',
        '—Ñ': 'f', '—Ö': 'h', '—Ü': 'ts', '—á': 'ch', '—à': 'sh', '—â': 'sch',
        '—ä': '', '—ã': 'y', '—å': '', '—ç': 'e', '—é': 'yu', '—è': 'ya'
    }
    
    —Ç–µ–∫—Å—Ç = —Ç–µ–∫—Å—Ç.lower()
    slug = ''
    for char in —Ç–µ–∫—Å—Ç:
        if char in —Ç—Ä–∞–Ω—Å–ª–∏—Ç:
            slug += —Ç—Ä–∞–Ω—Å–ª–∏—Ç[char]
        elif char.isalnum() or char in '- ':
            slug += char
        else:
            slug += '-'
    
    # –û—á–∏—â–∞–µ–º –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
    slug = re.sub(r'[-\s]+', '-', slug)
    slug = slug.strip('-')[:50]
    
    if not slug:
        slug = post_id
    
    return slug

def –∏–∑–≤–ª–µ—á—å_–∑–∞–≥–æ–ª–æ–≤–∫–∏_–∏–∑_—Ç–µ–∫—Å—Ç–∞(—Ç–µ–∫—Å—Ç):
    """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –∏ —Å–æ–∑–¥–∞—ë—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É H1-H6"""
    if not —Ç–µ–∫—Å—Ç:
        return {'h1': '', 'h2': [], 'h3': [], 'h4': []}
    
    # –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ HTML
    h2_pattern = r'<h2[^>]*>(.*?)</h2>'
    h3_pattern = r'<h3[^>]*>(.*?)</h3>'
    h4_pattern = r'<h4[^>]*>(.*?)</h4>'
    
    h2_matches = re.findall(h2_pattern, —Ç–µ–∫—Å—Ç, re.IGNORECASE | re.DOTALL)
    h3_matches = re.findall(h3_pattern, —Ç–µ–∫—Å—Ç, re.IGNORECASE | re.DOTALL)
    h4_matches = re.findall(h4_pattern, —Ç–µ–∫—Å—Ç, re.IGNORECASE | re.DOTALL)
    
    # –û—á–∏—â–∞–µ–º –æ—Ç HTML —Ç–µ–≥–æ–≤
    def –æ—á–∏—Å—Ç–∏—Ç—å(html):
        return re.sub(r'<[^>]+>', '', html).strip()
    
    return {
        'h1': '',  # H1 –±—É–¥–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–æ–º —Å—Ç–∞—Ç—å–∏
        'h2': [–æ—á–∏—Å—Ç–∏—Ç—å(h) for h in h2_matches],
        'h3': [–æ—á–∏—Å—Ç–∏—Ç—å(h) for h in h3_matches],
        'h4': [–æ—á–∏—Å—Ç–∏—Ç—å(h) for h in h4_matches]
    }

def —Å–æ–∑–¥–∞—Ç—å_—É–Ω–∏–∫–∞–ª—å–Ω—ã–π_alt_–¥–ª—è_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è(–∑–∞–≥–æ–ª–æ–≤–æ–∫, —Ç–µ–≥–∏, –∏–Ω–¥–µ–∫—Å=0):
    """–°–æ–∑–¥–∞—ë—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π alt –∏ title –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"""
    –≤–∞—Ä–∏–∞—Ü–∏–∏_alt = [
        f"{–∑–∞–≥–æ–ª–æ–≤–æ–∫} - —Ñ–æ—Ç–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ —Ñ–∏—Ç–Ω–µ—Å–∞",
        f"–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –∫ —Å—Ç–∞—Ç—å–µ: {–∑–∞–≥–æ–ª–æ–≤–æ–∫}",
        f"–§–æ—Ç–æ –¥–ª—è —Å—Ç–∞—Ç—å–∏ –æ {', '.join(—Ç–µ–≥–∏[:2])}",
        f"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: {–∑–∞–≥–æ–ª–æ–≤–æ–∫} | TABATATIMER.RU",
        f"–§–æ—Ç–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: {–∑–∞–≥–æ–ª–æ–≤–æ–∫}"
    ]
    
    –≤–∞—Ä–∏–∞—Ü–∏–∏_title = [
        f"{–∑–∞–≥–æ–ª–æ–≤–æ–∫} - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ñ–æ—Ç–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏",
        f"–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç—å–∏ –æ —Ñ–∏—Ç–Ω–µ—Å–µ: {–∑–∞–≥–æ–ª–æ–≤–æ–∫}",
        f"–§–æ—Ç–æ –¥–ª—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞: {–∑–∞–≥–æ–ª–æ–≤–æ–∫}",
        f"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏: {–∑–∞–≥–æ–ª–æ–≤–æ–∫} | –ë–ª–æ–≥ TABATATIMER.RU",
        f"–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: {–∑–∞–≥–æ–ª–æ–≤–æ–∫}"
    ]
    
    alt = –≤–∞—Ä–∏–∞—Ü–∏–∏_alt[–∏–Ω–¥–µ–∫—Å % len(–≤–∞—Ä–∏–∞—Ü–∏–∏_alt)]
    title = –≤–∞—Ä–∏–∞—Ü–∏–∏_title[–∏–Ω–¥–µ–∫—Å % len(–≤–∞—Ä–∏–∞—Ü–∏–∏_title)]
    
    # –î–æ–±–∞–≤–ª—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
    —É–Ω–∏–∫–∞–ª—å–Ω—ã–π_—Å—É—Ñ—Ñ–∏–∫—Å = f" | ID: {hash(–∑–∞–≥–æ–ª–æ–≤–æ–∫ + str(–∏–Ω–¥–µ–∫—Å)) % 10000}"
    alt += —É–Ω–∏–∫–∞–ª—å–Ω—ã–π_—Å—É—Ñ—Ñ–∏–∫—Å
    title += —É–Ω–∏–∫–∞–ª—å–Ω—ã–π_—Å—É—Ñ—Ñ–∏–∫—Å
    
    return alt, title

def —Å–æ–∑–¥–∞—Ç—å_—É–Ω–∏–∫–∞–ª—å–Ω—É—é_—Å—Å—ã–ª–∫—É_–Ω–∞_—Ç–∞–π–º–µ—Ä(—Ç–µ–∫—Å—Ç, —Ç–µ–≥–∏, –∏–Ω–¥–µ–∫—Å=0):
    """–°–æ–∑–¥–∞—ë—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–∞–π–º–µ—Ä —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º title"""
    –≤–∞—Ä–∏–∞—Ü–∏–∏_—Ç–µ–∫—Å—Ç–∞ = [
        "–ó–∞–ø—É—Å—Ç–∏ —Ç–∞–π–º–µ—Ä TABATA",
        "–ò—Å–ø–æ–ª—å–∑—É–π —Ç–∞–π–º–µ—Ä HIIT",
        "–ù–∞—á–Ω–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É —Å —Ç–∞–π–º–µ—Ä–æ–º",
        "–û—Ç–∫—Ä–æ–π —Ç–∞–π–º–µ—Ä –¥–ª—è –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫",
        "–ó–∞–ø—É—Å—Ç–∏ –æ–Ω–ª–∞–π–Ω —Ç–∞–π–º–µ—Ä",
        "–ò—Å–ø–æ–ª—å–∑—É–π —Ç–∞–π–º–µ—Ä AMRAP",
        "–ù–∞—á–Ω–∏ —Å —Ç–∞–π–º–µ—Ä–æ–º EMOM",
        "–û—Ç–∫—Ä–æ–π —Ç–∞–π–º–µ—Ä TABATATIMER.RU"
    ]
    
    –≤–∞—Ä–∏–∞—Ü–∏–∏_title = [
        f"–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–∞–π–º–µ—Ä –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: {', '.join(—Ç–µ–≥–∏[:2])}",
        f"–û–Ω–ª–∞–π–Ω —Ç–∞–π–º–µ—Ä –¥–ª—è –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ - {', '.join(—Ç–µ–≥–∏[:2])}",
        f"–¢–∞–π–º–µ—Ä TABATA, HIIT, AMRAP, EMOM –¥–ª—è {', '.join(—Ç–µ–≥–∏[:2])}",
        f"–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –æ–Ω–ª–∞–π–Ω —Ç–∞–π–º–µ—Ä –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫: {', '.join(—Ç–µ–≥–∏[:2])}",
        f"–¢–∞–π–º–µ—Ä –¥–ª—è —Ñ–∏—Ç–Ω–µ—Å–∞: {', '.join(—Ç–µ–≥–∏[:2])}",
        f"–ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π —Ç–∞–π–º–µ—Ä –æ–Ω–ª–∞–π–Ω: {', '.join(—Ç–µ–≥–∏[:2])}",
        f"–¢–∞–π–º–µ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ TABATATIMER.RU: {', '.join(—Ç–µ–≥–∏[:2])}",
        f"–û–Ω–ª–∞–π–Ω —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä –¥–ª—è {', '.join(—Ç–µ–≥–∏[:2])}"
    ]
    
    —Ç–µ–∫—Å—Ç_—Å—Å—ã–ª–∫–∏ = –≤–∞—Ä–∏–∞—Ü–∏–∏_—Ç–µ–∫—Å—Ç–∞[–∏–Ω–¥–µ–∫—Å % len(–≤–∞—Ä–∏–∞—Ü–∏–∏_—Ç–µ–∫—Å—Ç–∞)]
    title_—Å—Å—ã–ª–∫–∏ = –≤–∞—Ä–∏–∞—Ü–∏–∏_title[–∏–Ω–¥–µ–∫—Å % len(–≤–∞—Ä–∏–∞—Ü–∏–∏_title)]
    
    # –î–æ–±–∞–≤–ª—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
    —É–Ω–∏–∫–∞–ª—å–Ω—ã–π_—Å—É—Ñ—Ñ–∏–∫—Å = f" | ID: {hash(—Ç–µ–∫—Å—Ç + str(–∏–Ω–¥–µ–∫—Å)) % 10000}"
    title_—Å—Å—ã–ª–∫–∏ += —É–Ω–∏–∫–∞–ª—å–Ω—ã–π_—Å—É—Ñ—Ñ–∏–∫—Å
    
    return —Ç–µ–∫—Å—Ç_—Å—Å—ã–ª–∫–∏, title_—Å—Å—ã–ª–∫–∏

def —Å–æ–∑–¥–∞—Ç—å_–∑–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π_–±–ª–æ–∫_–ø—Ä–æ_—Ç–∞–π–º–µ—Ä(—Ç–µ–∫—Å—Ç, —Ç–µ–≥–∏):
    """–°–æ–∑–¥–∞—ë—Ç –∑–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π –±–ª–æ–∫ –ø—Ä–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞"""
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ä–µ–∂–∏–º —Ç–∞–π–º–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–≥–æ–≤ –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è
    —Ä–µ–∂–∏–º_—Ç–∞–π–º–µ—Ä–∞ = None
    –æ–ø–∏—Å–∞–Ω–∏–µ_—Ä–µ–∂–∏–º–∞ = ""
    
    —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π = —Ç–µ–∫—Å—Ç.lower()
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∂–∏–º –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
    if 'tabata' in —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π or '—Ç–∞–±–∞—Ç–∞' in —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π:
        —Ä–µ–∂–∏–º_—Ç–∞–π–º–µ—Ä–∞ = 'TABATA'
        –æ–ø–∏—Å–∞–Ω–∏–µ_—Ä–µ–∂–∏–º–∞ = "–†–µ–∂–∏–º TABATA –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤—ã—Å–æ–∫–æ–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫: 20 —Å–µ–∫—É–Ω–¥ —Ä–∞–±–æ—Ç—ã –∏ 10 —Å–µ–∫—É–Ω–¥ –æ—Ç–¥—ã—Ö–∞. –≠—Ç–æ—Ç —Ä–µ–∂–∏–º –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Å–∂–∏–≥–∞—Ç—å –∫–∞–ª–æ—Ä–∏–∏ –∏ —É–ª—É—á—à–∞—Ç—å –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å."
    elif 'hiit' in —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π or '–≤—ã—Å–æ–∫–æ–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω' in —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π or '–∫–∞—Ä–¥–∏–æ' in —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π:
        —Ä–µ–∂–∏–º_—Ç–∞–π–º–µ—Ä–∞ = 'HIIT'
        –æ–ø–∏—Å–∞–Ω–∏–µ_—Ä–µ–∂–∏–º–∞ = "–†–µ–∂–∏–º HIIT (–≤—ã—Å–æ–∫–æ–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∞—è –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞) –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–∞—Ä–¥–∏–æ-–Ω–∞–≥—Ä—É–∑–æ–∫ –∏ —Å–∂–∏–≥–∞–Ω–∏—è –∂–∏—Ä–∞. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã —Ä–∞–±–æ—Ç—ã –∏ –æ—Ç–¥—ã—Ö–∞ –ø–æ–¥ —Å–≤–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏."
    elif 'emom' in —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π or '–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É' in —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π:
        —Ä–µ–∂–∏–º_—Ç–∞–π–º–µ—Ä–∞ = 'EMOM'
        –æ–ø–∏—Å–∞–Ω–∏–µ_—Ä–µ–∂–∏–º–∞ = "–†–µ–∂–∏–º EMOM (Every Minute On the Minute) –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è —Å–∏–ª–æ–≤—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π. –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∑–∞–¥–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–π –º–∏–Ω—É—Ç—ã."
    elif 'amrap' in —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π or '–º–∞–∫—Å–∏–º—É–º –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π' in —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π:
        —Ä–µ–∂–∏–º_—Ç–∞–π–º–µ—Ä–∞ = 'AMRAP'
        –æ–ø–∏—Å–∞–Ω–∏–µ_—Ä–µ–∂–∏–º–∞ = "–†–µ–∂–∏–º AMRAP (As Many Rounds As Possible) –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫—Ä—É–≥–æ–≤—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤ –∑–∞ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è. –û—Ç–ª–∏—á–Ω–æ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å –∏ —Å–∏–ª—É."
    else:
        # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ–º TABATA –∏–ª–∏ HIIT –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–≥–æ–≤
        if '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞' in —Ç–µ–≥–∏ or '–ú—É–∂—á–∏–Ω–∞–º' in —Ç–µ–≥–∏ or '–î–µ–≤—É—à–∫–∞–º' in —Ç–µ–≥–∏:
            —Ä–µ–∂–∏–º_—Ç–∞–π–º–µ—Ä–∞ = 'TABATA'
            –æ–ø–∏—Å–∞–Ω–∏–µ_—Ä–µ–∂–∏–º–∞ = "–†–µ–∂–∏–º TABATA –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫: 20 —Å–µ–∫—É–Ω–¥ —Ä–∞–±–æ—Ç—ã –∏ 10 —Å–µ–∫—É–Ω–¥ –æ—Ç–¥—ã—Ö–∞. –≠—Ç–æ—Ç —Ä–µ–∂–∏–º –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Å–∂–∏–≥–∞—Ç—å –∫–∞–ª–æ—Ä–∏–∏ –∏ —É–ª—É—á—à–∞—Ç—å –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å."
        else:
            —Ä–µ–∂–∏–º_—Ç–∞–π–º–µ—Ä–∞ = 'HIIT'
            –æ–ø–∏—Å–∞–Ω–∏–µ_—Ä–µ–∂–∏–º–∞ = "–†–µ–∂–∏–º HIIT (–≤—ã—Å–æ–∫–æ–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∞—è –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞) –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã —Ä–∞–±–æ—Ç—ã –∏ –æ—Ç–¥—ã—Ö–∞ –ø–æ–¥ —Å–≤–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏."
    
    # –°–æ–∑–¥–∞—ë–º —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É
    —Ç–µ–∫—Å—Ç_—Å—Å—ã–ª–∫–∏, title_—Å—Å—ã–ª–∫–∏ = —Å–æ–∑–¥–∞—Ç—å_—É–Ω–∏–∫–∞–ª—å–Ω—É—é_—Å—Å—ã–ª–∫—É_–Ω–∞_—Ç–∞–π–º–µ—Ä(—Ç–µ–∫—Å—Ç, —Ç–µ–≥–∏, 999)
    
    –±–ª–æ–∫ = f'''
    <div class="blog-timer-block">
        <h3>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π —Ç–∞–π–º–µ—Ä –¥–ª—è —ç—Ç–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã</h3>
        <p>{–æ–ø–∏—Å–∞–Ω–∏–µ_—Ä–µ–∂–∏–º–∞}</p>
        <p>–î–ª—è —ç—Ç–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∂–∏–º <strong>{—Ä–µ–∂–∏–º_—Ç–∞–π–º–µ—Ä–∞}</strong> –Ω–∞ <a href="https://www.tabatatimer.ru/#timer" target="_blank" rel="noopener noreferrer" title="{title_—Å—Å—ã–ª–∫–∏}">tabatatimer.ru</a>. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º:</p>
        <ul>
            <li>–°—Ç—Ä–æ–≥–æ —Å–æ–±–ª—é–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã —Ä–∞–±–æ—Ç—ã –∏ –æ—Ç–¥—ã—Ö–∞</li>
            <li>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Ä–µ–º—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</li>
            <li>–û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —É–ª—É—á—à–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
            <li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤—ã—Å–æ–∫—É—é –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</li>
        </ul>
        <p><a href="https://www.tabatatimer.ru/#timer" target="_blank" rel="noopener noreferrer" title="{title_—Å—Å—ã–ª–∫–∏}">{—Ç–µ–∫—Å—Ç_—Å—Å—ã–ª–∫–∏}</a> –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å –∏ –Ω–∞—á–Ω–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ!</p>
    </div>
    '''
    return –±–ª–æ–∫

def —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å_—Ç–µ–∫—Å—Ç_–¥–ª—è_html(—Ç–µ–∫—Å—Ç, –∑–∞–≥–æ–ª–æ–≤–æ–∫, —Ç–µ–≥–∏):
    """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ –¥–ª—è HTML —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π (h3, h4, —Å–ø–∏—Å–∫–∏, –∞–±–∑–∞—Ü—ã)"""
    if not —Ç–µ–∫—Å—Ç:
        return ''
    
    # –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ tabatatimer.ru –∏–∑ –Ω–∞—á–∞–ª–∞ —Ç–µ–∫—Å—Ç–∞
    # –ü–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—Å—ã–ª–æ–∫ –≤ –Ω–∞—á–∞–ª–µ —Ç–µ–∫—Å—Ç–∞
    —Ç–µ–∫—Å—Ç = re.sub(r'^.*?tabatatimer\.ru.*?\n', '', —Ç–µ–∫—Å—Ç, flags=re.IGNORECASE | re.MULTILINE)
    —Ç–µ–∫—Å—Ç = re.sub(r'^.*?–ó–∞–ø—É—Å—Ç–∏ —Ç–∞–π–º–µ—Ä.*?\n', '', —Ç–µ–∫—Å—Ç, flags=re.IGNORECASE | re.MULTILINE)
    
    # –†–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ —Å—Ç—Ä–æ–∫–∏
    —Å—Ç—Ä–æ–∫–∏ = —Ç–µ–∫—Å—Ç.split('\n')
    –±–ª–æ–∫–∏ = []
    —Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü = []
    —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫ = []
    –≤_—Å–ø–∏—Å–∫–µ = False
    
    # –°–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
    –Ω–∞–∑–≤–∞–Ω–∏—è_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π = [
        '–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è', '–≤—ã–ø–∞–¥—ã', '–ø—Ä—ã–∂–∫–∏ –≤ –ø–ª–∞–Ω–∫–µ', '–ø–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏',
        '–æ—Ç–∂–∏–º–∞–Ω–∏—è', '–æ–±—Ä–∞—Ç–Ω—ã–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è', '—Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è', '–ø–ª–∞–Ω–∫–∞',
        '–±—ë—Ä–ø–∏', '–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å –ø—Ä—ã–∂–∫–æ–º', '–∞–ª—å–ø–∏–Ω–∏—Å—Ç', '–≤–µ–ª–æ—Å–∏–ø–µ–¥',
        '—è–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç–∏–∫', '–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å—É–º–æ', '–º–∞—Ö–∏ –Ω–æ–≥–æ–π –Ω–∞–∑–∞–¥', '–±–æ–∫–æ–≤–∞—è –ø–ª–∞–Ω–∫–∞',
        '–∂–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞', '–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è', '–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å—Ç–æ—è', '–æ—Ç–∂–∏–º–∞–Ω–∏—è –Ω–∞ –±—Ä—É—Å—å—è—Ö',
        '–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π', '—Å—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞', '—Ç—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ',
        '–ø–æ–¥—ä—ë–º —à—Ç–∞–Ω–≥–∏ –Ω–∞ –±–∏—Ü–µ–ø—Å', '—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –∂–∏–º', '–º–æ–ª–æ—Ç–∫–∏'
    ]
    
    def —ç—Ç–æ_—Å—Ç—Ä–æ–∫–∞_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è(—Å—Ç—Ä–æ–∫–∞):
        –Ω–∏–∂–Ω–∏–π = —Å—Ç—Ä–æ–∫–∞.lower()
        return any(–Ω–∞–∑–≤–∞–Ω–∏–µ in –Ω–∏–∂–Ω–∏–π for –Ω–∞–∑–≤–∞–Ω–∏–µ in –Ω–∞–∑–≤–∞–Ω–∏—è_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π) or \
               re.match(r'^\d+\.', —Å—Ç—Ä–æ–∫–∞) or \
               re.match(r'^-\s', —Å—Ç—Ä–æ–∫–∞) or \
               re.search(r'—Å–µ–∫—É–Ω–¥|—Ä–∞—É–Ω–¥|–ø–æ–¥—Ö–æ–¥|–ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ', –Ω–∏–∂–Ω–∏–π, re.IGNORECASE)
    
    def —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å_—Å—Ç—Ä–æ–∫—É_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è(—Å—Ç—Ä–æ–∫–∞):
        # –£–±–∏—Ä–∞–µ–º markdown
        —Å—Ç—Ä–æ–∫–∞ = re.sub(r'\*\*([^*]+)\*\*', r'\1', —Å—Ç—Ä–æ–∫–∞)
        —Å—Ç—Ä–æ–∫–∞ = re.sub(r'\*([^*]+)\*', r'\1', —Å—Ç—Ä–æ–∫–∞)
        
        # –£–±–∏—Ä–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ "- " –∏–ª–∏ –Ω–æ–º–µ—Ä —Å —Ç–æ—á–∫–æ–π
        —Å—Ç—Ä–æ–∫–∞ = re.sub(r'^-\s*', '', —Å—Ç—Ä–æ–∫–∞)
        —Å—Ç—Ä–æ–∫–∞ = re.sub(r'^\d+\.\s*', '', —Å—Ç—Ä–æ–∫–∞)
        
        # –ù–∞—Ö–æ–¥–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        –∏–Ω–¥–µ–∫—Å_–¥–≤–æ–µ—Ç–æ—á–∏—è = —Å—Ç—Ä–æ–∫–∞.find(':')
        —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ_—Ü–∏—Ñ—Ä—ã = re.search(r'\d', —Å—Ç—Ä–æ–∫–∞)
        –∏–Ω–¥–µ–∫—Å_—Ü–∏—Ñ—Ä—ã = —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ_—Ü–∏—Ñ—Ä—ã.start() if —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ_—Ü–∏—Ñ—Ä—ã else -1
        
        –Ω–∞–∑–≤–∞–Ω–∏–µ_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è = ''
        –æ—Å—Ç–∞—Ç–æ–∫ = ''
        
        if –∏–Ω–¥–µ–∫—Å_–¥–≤–æ–µ—Ç–æ—á–∏—è > 0 and (–∏–Ω–¥–µ–∫—Å_—Ü–∏—Ñ—Ä—ã == -1 or –∏–Ω–¥–µ–∫—Å_–¥–≤–æ–µ—Ç–æ—á–∏—è < –∏–Ω–¥–µ–∫—Å_—Ü–∏—Ñ—Ä—ã):
            –Ω–∞–∑–≤–∞–Ω–∏–µ_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è = —Å—Ç—Ä–æ–∫–∞[:–∏–Ω–¥–µ–∫—Å_–¥–≤–æ–µ—Ç–æ—á–∏—è].strip()
            –æ—Å—Ç–∞—Ç–æ–∫ = —Å—Ç—Ä–æ–∫–∞[–∏–Ω–¥–µ–∫—Å_–¥–≤–æ–µ—Ç–æ—á–∏—è + 1:].strip()
        elif –∏–Ω–¥–µ–∫—Å_—Ü–∏—Ñ—Ä—ã > 0:
            –Ω–∞–∑–≤–∞–Ω–∏–µ_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è = —Å—Ç—Ä–æ–∫–∞[:–∏–Ω–¥–µ–∫—Å_—Ü–∏—Ñ—Ä—ã].strip()
            –æ—Å—Ç–∞—Ç–æ–∫ = —Å—Ç—Ä–æ–∫–∞[–∏–Ω–¥–µ–∫—Å_—Ü–∏—Ñ—Ä—ã:].strip()
        else:
            –∏–Ω–¥–µ–∫—Å_–∑–∞–ø—è—Ç–æ–π = —Å—Ç—Ä–æ–∫–∞.find(',')
            –∏–Ω–¥–µ–∫—Å_—Ç–∏—Ä–µ = —Å—Ç—Ä–æ–∫–∞.find(' - ')
            if –∏–Ω–¥–µ–∫—Å_–∑–∞–ø—è—Ç–æ–π > 0:
                –Ω–∞–∑–≤–∞–Ω–∏–µ_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è = —Å—Ç—Ä–æ–∫–∞[:–∏–Ω–¥–µ–∫—Å_–∑–∞–ø—è—Ç–æ–π].strip()
                –æ—Å—Ç–∞—Ç–æ–∫ = —Å—Ç—Ä–æ–∫–∞[–∏–Ω–¥–µ–∫—Å_–∑–∞–ø—è—Ç–æ–π + 1:].strip()
            elif –∏–Ω–¥–µ–∫—Å_—Ç–∏—Ä–µ > 0:
                –Ω–∞–∑–≤–∞–Ω–∏–µ_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è = —Å—Ç—Ä–æ–∫–∞[:–∏–Ω–¥–µ–∫—Å_—Ç–∏—Ä–µ].strip()
                –æ—Å—Ç–∞—Ç–æ–∫ = —Å—Ç—Ä–æ–∫–∞[–∏–Ω–¥–µ–∫—Å_—Ç–∏—Ä–µ + 3:].strip()
            else:
                –Ω–∞–∑–≤–∞–Ω–∏–µ_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è = —Å—Ç—Ä–æ–∫–∞
                –æ—Å—Ç–∞—Ç–æ–∫ = ''
        
        # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è
        –Ω–∞–∑–≤–∞–Ω–∏–µ_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è = re.sub(r'[:\-,]$', '', –Ω–∞–∑–≤–∞–Ω–∏–µ_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è).strip()
        –æ—Å—Ç–∞—Ç–æ–∫ = re.sub(r'^[:\-,]\s*', '', –æ—Å—Ç–∞—Ç–æ–∫).strip()
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –≤ UPPERCASE –∏ –∂–∏—Ä–Ω—ã–º
        —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ_–Ω–∞–∑–≤–∞–Ω–∏–µ = f'<strong>{html.escape(–Ω–∞–∑–≤–∞–Ω–∏–µ_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è.upper())}</strong>'
        
        if –æ—Å—Ç–∞—Ç–æ–∫:
            return f'{—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ_–Ω–∞–∑–≤–∞–Ω–∏–µ} {html.escape(–æ—Å—Ç–∞—Ç–æ–∫)}'
        return —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ_–Ω–∞–∑–≤–∞–Ω–∏–µ
    
    for —Å—Ç—Ä–æ–∫–∞ in —Å—Ç—Ä–æ–∫–∏:
        —Å—Ç—Ä–æ–∫–∞ = —Å—Ç—Ä–æ–∫–∞.strip()
        
        # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
        if not —Å—Ç—Ä–æ–∫–∞:
            if —Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü:
                –±–ª–æ–∫–∏.append({'type': 'paragraph', 'content': ' '.join(—Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü)})
                —Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü = []
            if —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫:
                –±–ª–æ–∫–∏.append({'type': 'list', 'content': —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫, 'ordered': True})
                —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫ = []
                –≤_—Å–ø–∏—Å–∫–µ = False
            continue
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ h3 –∏–ª–∏ h4
        if —Å—Ç—Ä–æ–∫–∞.startswith('**') and —Å—Ç—Ä–æ–∫–∞.endswith('**') and len(—Å—Ç—Ä–æ–∫–∞) > 4:
            if —Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü:
                –±–ª–æ–∫–∏.append({'type': 'paragraph', 'content': ' '.join(—Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü)})
                —Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü = []
            if —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫:
                –±–ª–æ–∫–∏.append({'type': 'list', 'content': —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫, 'ordered': True})
                —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫ = []
                –≤_—Å–ø–∏—Å–∫–µ = False
            
            —Ç–µ–∫—Å—Ç_–∑–∞–≥–æ–ª–æ–≤–∫–∞ = —Å—Ç—Ä–æ–∫–∞.replace('**', '')
            if re.match(r'^–î–µ–Ω—å\s+\d+:', —Ç–µ–∫—Å—Ç_–∑–∞–≥–æ–ª–æ–≤–∫–∞, re.IGNORECASE):
                –±–ª–æ–∫–∏.append({'type': 'h4', 'content': —Ç–µ–∫—Å—Ç_–∑–∞–≥–æ–ª–æ–≤–∫–∞})
            else:
                –±–ª–æ–∫–∏.append({'type': 'h3', 'content': —Ç–µ–∫—Å—Ç_–∑–∞–≥–æ–ª–æ–≤–∫–∞})
            continue
        
        # –°—Ç—Ä–æ–∫–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è (—Å–ø–∏—Å–æ–∫)
        if —ç—Ç–æ_—Å—Ç—Ä–æ–∫–∞_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è(—Å—Ç—Ä–æ–∫–∞):
            if —Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü:
                –±–ª–æ–∫–∏.append({'type': 'paragraph', 'content': ' '.join(—Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü)})
                —Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü = []
            –≤_—Å–ø–∏—Å–∫–µ = True
            —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫.append(—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å_—Å—Ç—Ä–æ–∫—É_—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è(—Å—Ç—Ä–æ–∫–∞))
            continue
        
        # –û–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
        if –≤_—Å–ø–∏—Å–∫–µ:
            –±–ª–æ–∫–∏.append({'type': 'list', 'content': —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫, 'ordered': True})
            —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫ = []
            –≤_—Å–ø–∏—Å–∫–µ = False
        
        # –£–±–∏—Ä–∞–µ–º markdown –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º
        —Å—Ç—Ä–æ–∫–∞ = re.sub(r'\*\*([^*]+)\*\*', r'<strong>\1</strong>', —Å—Ç—Ä–æ–∫–∞)
        —Å—Ç—Ä–æ–∫–∞ = re.sub(r'\*([^*]+)\*', r'\1', —Å—Ç—Ä–æ–∫–∞)
        
        # –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º HTML, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Ç–µ–≥–∏
        —á–∞—Å—Ç–∏ = re.split(r'(<[^>]+>)', —Å—Ç—Ä–æ–∫–∞)
        —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ_—á–∞—Å—Ç–∏ = []
        for —á–∞—Å—Ç—å in —á–∞—Å—Ç–∏:
            if —á–∞—Å—Ç—å.startswith('<') and —á–∞—Å—Ç—å.endswith('>'):
                —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ_—á–∞—Å—Ç–∏.append(—á–∞—Å—Ç—å)
            else:
                —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ_—á–∞—Å—Ç–∏.append(html.escape(—á–∞—Å—Ç—å))
        —Å—Ç—Ä–æ–∫–∞ = ''.join(—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ_—á–∞—Å—Ç–∏)
        
        —Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü.append(—Å—Ç—Ä–æ–∫–∞)
    
    # –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ –±–ª–æ–∫–∏
    if —Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü:
        –±–ª–æ–∫–∏.append({'type': 'paragraph', 'content': ' '.join(—Ç–µ–∫—É—â–∏–π_–∞–±–∑–∞—Ü)})
    if —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫:
        –±–ª–æ–∫–∏.append({'type': 'list', 'content': —Ç–µ–∫—É—â–∏–π_—Å–ø–∏—Å–æ–∫, 'ordered': True})
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º HTML
    —Ä–µ–∑—É–ª—å—Ç–∞—Ç = []
    for –±–ª–æ–∫ in –±–ª–æ–∫–∏:
        if –±–ª–æ–∫['type'] == 'h3':
            —Ä–µ–∑—É–ª—å—Ç–∞—Ç.append(f"<h3>{html.escape(–±–ª–æ–∫['content'])}</h3>")
        elif –±–ª–æ–∫['type'] == 'h4':
            —Ä–µ–∑—É–ª—å—Ç–∞—Ç.append(f"<h4>{html.escape(–±–ª–æ–∫['content'])}</h4>")
        elif –±–ª–æ–∫['type'] == 'list':
            —ç–ª–µ–º–µ–Ω—Ç—ã = ''.join([f"<li>{—ç–ª–µ–º–µ–Ω—Ç}</li>" for —ç–ª–µ–º–µ–Ω—Ç in –±–ª–æ–∫['content']])
            —Ä–µ–∑—É–ª—å—Ç–∞—Ç.append(f"<ol>{—ç–ª–µ–º–µ–Ω—Ç—ã}</ol>")
        elif –±–ª–æ–∫['type'] == 'paragraph':
            —Ä–µ–∑—É–ª—å—Ç–∞—Ç.append(f"<p>{–±–ª–æ–∫['content']}</p>")
    
    —Ç–µ–∫—Å—Ç_html = ''.join(—Ä–µ–∑—É–ª—å—Ç–∞—Ç)
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π –±–ª–æ–∫ –ø—Ä–æ —Ç–∞–π–º–µ—Ä –≤ –∫–æ–Ω–µ—Ü
    –∑–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π_–±–ª–æ–∫ = —Å–æ–∑–¥–∞—Ç—å_–∑–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π_–±–ª–æ–∫_–ø—Ä–æ_—Ç–∞–π–º–µ—Ä(—Ç–µ–∫—Å—Ç, —Ç–µ–≥–∏)
    —Ç–µ–∫—Å—Ç_html += –∑–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π_–±–ª–æ–∫
    
    # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è - –¥–æ–±–∞–≤–ª—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ alt –∏ title
    —Å—á—ë—Ç—á–∏–∫_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π = 0
    def –∑–∞–º–µ–Ω–∏—Ç—å_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ(match):
        nonlocal —Å—á—ë—Ç—á–∏–∫_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        –ø–æ–ª–Ω—ã–π_—Ç–µ–≥ = match.group(0)
        alt, title = —Å–æ–∑–¥–∞—Ç—å_—É–Ω–∏–∫–∞–ª—å–Ω—ã–π_alt_–¥–ª—è_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è(–∑–∞–≥–æ–ª–æ–≤–æ–∫, —Ç–µ–≥–∏, —Å—á—ë—Ç—á–∏–∫_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
        —Å—á—ë—Ç—á–∏–∫_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π += 1
        
        if 'alt=' in –ø–æ–ª–Ω—ã–π_—Ç–µ–≥:
            –ø–æ–ª–Ω—ã–π_—Ç–µ–≥ = re.sub(r'alt=["\'][^"\']*["\']', f'alt="{alt}"', –ø–æ–ª–Ω—ã–π_—Ç–µ–≥)
        else:
            –ø–æ–ª–Ω—ã–π_—Ç–µ–≥ = –ø–æ–ª–Ω—ã–π_—Ç–µ–≥.replace('<img', f'<img alt="{alt}"')
        
        if 'title=' in –ø–æ–ª–Ω—ã–π_—Ç–µ–≥:
            –ø–æ–ª–Ω—ã–π_—Ç–µ–≥ = re.sub(r'title=["\'][^"\']*["\']', f'title="{title}"', –ø–æ–ª–Ω—ã–π_—Ç–µ–≥)
        else:
            –ø–æ–ª–Ω—ã–π_—Ç–µ–≥ = –ø–æ–ª–Ω—ã–π_—Ç–µ–≥.replace('<img', f'<img title="{title}"')
        
        return –ø–æ–ª–Ω—ã–π_—Ç–µ–≥
    
    —Ç–µ–∫—Å—Ç_html = re.sub(r'<img[^>]*>', –∑–∞–º–µ–Ω–∏—Ç—å_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —Ç–µ–∫—Å—Ç_html, flags=re.IGNORECASE)
    
    return —Ç–µ–∫—Å—Ç_html

def —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_html_—Å—Ç—Ä–∞–Ω–∏—Ü—É(–ø–æ—Å—Ç):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç HTML —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø–æ—Å—Ç–∞"""
    post_id = –ø–æ—Å—Ç.get('id', 'unknown')
    –∑–∞–≥–æ–ª–æ–≤–æ–∫ = –ø–æ—Å—Ç.get('title', '–°—Ç–∞—Ç—å—è')
    —Ç–µ–∫—Å—Ç = –ø–æ—Å—Ç.get('text', '')
    –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url = –ø–æ—Å—Ç.get('image', 'https://www.tabatatimer.ru/images/og-image.jpg')
    —Ç–µ–≥–∏ = –ø–æ—Å—Ç.get('tags', [])
    –¥–∞—Ç–∞_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏ = –ø–æ—Å—Ç.get('date', datetime.now().isoformat())
    timestamp = –ø–æ—Å—Ç.get('timestamp', int(datetime.now().timestamp()))
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ —Å–∫–∞—á–∏–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –æ–Ω–æ –µ—â—ë –Ω–µ –∏–∑ Yandex Cloud)
    if –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url and not –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url.startswith('https://www.tabatatimer.ru/images/blog/'):
        print(f"üì• –ü—Ä–æ–≤–µ—Ä—è—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: {–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url[:80]}...")
        –ª–æ–∫–∞–ª—å–Ω–æ–µ_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url = —Å–∫–∞—á–∞—Ç—å_–∏_–∑–∞–≥—Ä—É–∑–∏—Ç—å_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ(–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url, post_id)
        if –ª–æ–∫–∞–ª—å–Ω–æ–µ_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url and –ª–æ–∫–∞–ª—å–Ω–æ–µ_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url != –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url:
            –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ = –ª–æ–∫–∞–ª—å–Ω–æ–µ_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url
            print(f"‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é –ª–æ–∫–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: {–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ}")
        else:
            –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ = –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url
    else:
        –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ = –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ_url
    
    # –°–æ–∑–¥–∞—ë–º slug –¥–ª—è URL
    slug = —Å–æ–∑–¥–∞—Ç—å_slug(–∑–∞–≥–æ–ª–æ–≤–æ–∫, post_id)
    url = f"https://www.tabatatimer.ru/blog/{slug}.html"
    
    # –°–æ–∑–¥–∞—ë–º —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç–∞—Ç—å–∏
    –æ–ø–∏—Å–∞–Ω–∏–µ_—Ç–µ–∫—Å—Ç = –æ—á–∏—Å—Ç–∏—Ç—å_—Ç–µ–∫—Å—Ç_–æ—Ç_html(—Ç–µ–∫—Å—Ç)
    if –æ–ø–∏—Å–∞–Ω–∏–µ_—Ç–µ–∫—Å—Ç:
        # –ë–µ—Ä—ë–º –ø–µ—Ä–≤—ã–µ 150 —Å–∏–º–≤–æ–ª–æ–≤ –∏ –¥–æ–±–∞–≤–ª—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å—É—Ñ—Ñ–∏–∫—Å
        –æ–ø–∏—Å–∞–Ω–∏–µ = –æ–ø–∏—Å–∞–Ω–∏–µ_—Ç–µ–∫—Å—Ç[:150].strip()
        if len(–æ–ø–∏—Å–∞–Ω–∏–µ_—Ç–µ–∫—Å—Ç) > 150:
            –æ–ø–∏—Å–∞–Ω–∏–µ += '...'
        # –î–æ–±–∞–≤–ª—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è –ø–æ–ª–Ω–æ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
        —É–Ω–∏–∫–∞–ª—å–Ω—ã–π_id = hash(–∑–∞–≥–æ–ª–æ–≤–æ–∫ + str(timestamp)) % 10000
        –æ–ø–∏—Å–∞–Ω–∏–µ += f" | {', '.join(—Ç–µ–≥–∏)} | ID: {—É–Ω–∏–∫–∞–ª—å–Ω—ã–π_id}"
    else:
        –æ–ø–∏—Å–∞–Ω–∏–µ = f"–°—Ç–∞—Ç—å—è –æ —Ñ–∏—Ç–Ω–µ—Å–µ, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö –∏ –∑–¥–æ—Ä–æ–≤–æ–º –æ–±—Ä–∞–∑–µ –∂–∏–∑–Ω–∏. {', '.join(—Ç–µ–≥–∏)}. –£–Ω–∏–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫."
    
    # –°–æ–∑–¥–∞—ë–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π Title
    —É–Ω–∏–∫–∞–ª—å–Ω—ã–π_title = f"{–∑–∞–≥–æ–ª–æ–≤–æ–∫} | –ë–ª–æ–≥ TABATATIMER.RU | {', '.join(—Ç–µ–≥–∏)}"
    
    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É
    try:
        –¥–∞—Ç–∞_–æ–±—ä–µ–∫—Ç = datetime.fromisoformat(–¥–∞—Ç–∞_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏.replace('Z', '+00:00'))
        –¥–∞—Ç–∞_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏_iso = –¥–∞—Ç–∞_–æ–±—ä–µ–∫—Ç.strftime('%Y-%m-%d')
        –¥–∞—Ç–∞_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏_ru = –¥–∞—Ç–∞_–æ–±—ä–µ–∫—Ç.strftime('%d.%m.%Y')
    except:
        –¥–∞—Ç–∞_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏_iso = datetime.now().strftime('%Y-%m-%d')
        –¥–∞—Ç–∞_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏_ru = datetime.now().strftime('%d.%m.%Y')
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    –∑–∞–≥–æ–ª–æ–≤–∫–∏ = –∏–∑–≤–ª–µ—á—å_–∑–∞–≥–æ–ª–æ–≤–∫–∏_–∏–∑_—Ç–µ–∫—Å—Ç–∞(—Ç–µ–∫—Å—Ç)
    
    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –¥–ª—è HTML —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    —Ç–µ–∫—Å—Ç_html = —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å_—Ç–µ–∫—Å—Ç_–¥–ª—è_html(—Ç–µ–∫—Å—Ç, –∑–∞–≥–æ–ª–æ–≤–æ–∫, —Ç–µ–≥–∏)
    
    # –°–æ–∑–¥–∞—ë–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ alt –∏ title –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    alt_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, title_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è = —Å–æ–∑–¥–∞—Ç—å_—É–Ω–∏–∫–∞–ª—å–Ω—ã–π_alt_–¥–ª—è_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è(–∑–∞–≥–æ–ª–æ–≤–æ–∫, —Ç–µ–≥–∏, 0)
    
    # –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ —Ç–µ–≥–æ–≤
    –∫–ª—é—á–µ–≤—ã–µ_—Å–ª–æ–≤–∞ = ', '.join(—Ç–µ–≥–∏) + ', —Ñ–∏—Ç–Ω–µ—Å, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, —Ç–∞–±–∞—Ç–∞, hiit, amrap, emom'
    
    # –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏ –¥–ª—è JavaScript
    js_redirect = """if (window.location.hostname === 'tabatatimer.ru') {
            window.location.replace('https://www.tabatatimer.ru' + window.location.pathname + window.location.search + window.location.hash);
        }"""
    
    js_metrika = """(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
       m[i].l=1*new Date();
       for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
       k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
       (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

       ym(42580049, "init", {
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true,
            webvisor:true,
            trackHash:true
       });"""
    
    html = f"""<!DOCTYPE HTML>
<html lang="ru" prefix="article: http://ogp.me/ns/article#">
<head>
    <meta charset="utf-8" />
    
    <!-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å tabatatimer.ru –Ω–∞ www.tabatatimer.ru -->
    <script>
        {js_redirect}
    </script>
    
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
       {js_metrika}
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/42580049" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
    
    <title>{—É–Ω–∏–∫–∞–ª—å–Ω—ã–π_title}</title>
    
    <meta name="description" content="{–æ–ø–∏—Å–∞–Ω–∏–µ}">
    <meta name="keywords" content="{–∫–ª—é—á–µ–≤—ã–µ_—Å–ª–æ–≤–∞}">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="author" content="TABATATIMER.RU">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Russian">
    <meta name="revisit-after" content="7 days">
    <meta http-equiv="X-Robots-Tag" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <link rel="canonical" href="{url}">
    <link rel="alternate" hreflang="ru" href="{url}">
    <link rel="alternate" hreflang="x-default" href="{url}">
    <meta name="yandex-verification" content="5e156b77592f12f7" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="{url}">
    <meta property="og:title" content="{–∑–∞–≥–æ–ª–æ–≤–æ–∫}">
    <meta property="og:description" content="{–æ–ø–∏—Å–∞–Ω–∏–µ}">
    <meta property="og:image" content="{–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/jpeg">
    <meta property="og:image:alt" content="{–∑–∞–≥–æ–ª–æ–≤–æ–∫}">
    <meta property="og:locale" content="ru_RU">
    <meta property="og:site_name" content="TABATATIMER.RU">
    <meta property="article:published_time" content="{–¥–∞—Ç–∞_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏_iso}">
    <meta property="article:modified_time" content="{–¥–∞—Ç–∞_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏_iso}">
    <meta property="article:author" content="TABATATIMER.RU">
    <meta property="article:section" content="–§–∏—Ç–Ω–µ—Å">
    {''.join([f'<meta property="article:tag" content="{—Ç–µ–≥}">' for —Ç–µ–≥ in —Ç–µ–≥–∏])}
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="{url}">
    <meta name="twitter:title" content="{–∑–∞–≥–æ–ª–æ–≤–æ–∫}">
    <meta name="twitter:description" content="{–æ–ø–∏—Å–∞–Ω–∏–µ}">
    <meta name="twitter:image" content="{–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ}">
    
    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {{
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": {json.dumps(–∑–∞–≥–æ–ª–æ–≤–æ–∫)},
        "description": {json.dumps(–æ–ø–∏—Å–∞–Ω–∏–µ)},
        "image": {json.dumps(–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)},
        "datePublished": "{–¥–∞—Ç–∞_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏_iso}",
        "dateModified": "{–¥–∞—Ç–∞_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏_iso}",
        "author": {{
            "@type": "Organization",
            "name": "TABATATIMER.RU",
            "url": "https://www.tabatatimer.ru/"
        }},
        "publisher": {{
            "@type": "Organization",
            "name": "TABATATIMER.RU",
            "url": "https://www.tabatatimer.ru/",
            "logo": {{
                "@type": "ImageObject",
                "url": "https://www.tabatatimer.ru/images/og-image.jpg"
            }}
        }},
        "mainEntityOfPage": {{
            "@type": "WebPage",
            "@id": {json.dumps(url)}
        }},
        "keywords": {json.dumps(–∫–ª—é—á–µ–≤—ã–µ_—Å–ª–æ–≤–∞)}
    }}
    </script>
    
    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
    {{
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {{
                "@type": "ListItem",
                "position": 1,
                "name": "–ì–ª–∞–≤–Ω–∞—è",
                "item": "https://www.tabatatimer.ru/"
            }},
            {{
                "@type": "ListItem",
                "position": 2,
                "name": "–ë–ª–æ–≥",
                "item": "https://www.tabatatimer.ru/blog.html"
            }},
            {{
                "@type": "ListItem",
                "position": 3,
                "name": {json.dumps(–∑–∞–≥–æ–ª–æ–≤–æ–∫)},
                "item": {json.dumps(url)}
            }}
        ]
    }}
    </script>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="../favicon.ico">
    
    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/burger-menu.css">
    <link rel="stylesheet" href="../assets/css/font-awesome.min.css">
    
    <style>
        html, body {{
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }}
        
        .blog-post-page {{
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            color: rgba(255, 255, 255, 0.9);
            background: #1a1a1a;
            min-height: 100vh;
        }}
        
        .blog-post-header {{
            margin-bottom: 40px;
        }}
        
        .blog-post-title {{
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #fff;
            line-height: 1.2;
        }}
        
        .blog-post-meta {{
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 30px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
        }}
        
        .blog-post-image {{
            width: 100%;
            max-height: 500px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 30px;
        }}
        
        .blog-post-content {{
            line-height: 1.8;
            font-size: 1.1rem;
        }}
        
        .blog-post-content h2 {{
            font-size: 1.8rem;
            margin: 30px 0 15px 0;
            color: #7af5ff;
        }}
        
        .blog-post-content h3 {{
            font-size: 1.5rem;
            margin: 25px 0 12px 0;
            color: rgba(255, 255, 255, 0.9);
        }}
        
        .blog-post-content h4 {{
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
            color: rgba(255, 255, 255, 0.85);
        }}
        
        .blog-post-content p {{
            margin: 0 0 15px 0;
        }}
        
        .blog-post-content ul,
        .blog-post-content ol {{
            margin: 15px 0;
            padding-left: 30px;
        }}
        
        .blog-post-content li {{
            margin: 8px 0;
        }}
        
        .blog-post-content a {{
            color: #7af5ff;
            text-decoration: none;
        }}
        
        .blog-post-content a:hover {{
            text-decoration: underline;
        }}
        
        .blog-post-tags {{
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }}
        
        .blog-post-tag {{
            padding: 5px 12px;
            background: rgba(122, 245, 255, 0.1);
            border: 1px solid rgba(122, 245, 255, 0.3);
            border-radius: 20px;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
            color: rgba(255, 255, 255, 0.8);
        }}
        
        .blog-post-tag:hover {{
            background: rgba(122, 245, 255, 0.2);
            border-color: #7af5ff;
            color: #7af5ff;
            transform: translateY(-2px);
        }}
        
        .blog-timer-block {{
            margin-top: 40px;
            padding: 30px;
            background: rgba(122, 245, 255, 0.05);
            border: 1px solid rgba(122, 245, 255, 0.2);
            border-radius: 12px;
        }}
        
        .blog-timer-block h3 {{
            color: #7af5ff;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }}
        
        .blog-timer-block ul {{
            margin: 15px 0;
            padding-left: 25px;
        }}
        
        .blog-timer-block li {{
            margin: 8px 0;
            color: rgba(255, 255, 255, 0.8);
        }}
        
        .blog-timer-block a {{
            color: #7af5ff;
            text-decoration: none;
        }}
        
        .blog-timer-block a:hover {{
            text-decoration: underline;
        }}
        
        .blog-post-back {{
            display: inline-block;
            margin-bottom: 30px;
            color: #7af5ff;
            text-decoration: none;
            font-size: 0.9rem;
        }}
        
        .blog-post-back:hover {{
            text-decoration: underline;
        }}
        
        @media (max-width: 768px) {{
            .blog-post-title {{
                font-size: 1.8rem;
            }}
            
            .blog-post-page {{
                padding: 20px 15px;
            }}
        }}
    </style>
</head>
<body>
    <div class="blog-post-page">
        <a href="../blog.html" class="blog-post-back">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –±–ª–æ–≥—É</a>
        
        <article class="blog-post-header">
            <h1 class="blog-post-title">{–∑–∞–≥–æ–ª–æ–≤–æ–∫}</h1>
            
            <div class="blog-post-meta">
                <span>üìÖ {–¥–∞—Ç–∞_–ø—É–±–ª–∏–∫–∞—Ü–∏–∏_ru}</span>
                <span>üè∑Ô∏è {', '.join(—Ç–µ–≥–∏)}</span>
            </div>
            
            {f'<img src="{–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ}" alt="{alt_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è}" title="{title_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è}" class="blog-post-image" loading="lazy">' if –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ else ''}
        </article>
        
        <div class="blog-post-content">
            {—Ç–µ–∫—Å—Ç_html}
        </div>
        
        <div class="blog-post-tags">
            {''.join([f'<a href="../blog.html?filter={quote(—Ç–µ–≥)}" class="blog-post-tag">{—Ç–µ–≥}</a>' for —Ç–µ–≥ in —Ç–µ–≥–∏])}
        </div>
    </div>
    
    <!-- Burger Menu Script -->
    <script src="../assets/js/burger-menu.js"></script>
</body>
</html>"""
    
    return html, slug

def –æ–±–Ω–æ–≤–∏—Ç—å_sitemap():
    """–û–±–Ω–æ–≤–ª—è–µ—Ç sitemap.xml —Å–æ –≤—Å–µ–º–∏ —Å—Ç–∞—Ç—å—è–º–∏ –±–ª–æ–≥–∞"""
    if not BLOG_POSTS_FILE.exists():
        return
    
    with open(BLOG_POSTS_FILE, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    –ø–æ—Å—Ç—ã = data.get('posts', [])
    
    # –ß–∏—Ç–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π sitemap –∏–ª–∏ —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π
    sitemap_file = Path('../public_html/sitemap.xml')
    sitemap_entries = []
    
    if sitemap_file.exists():
        # –ü–∞—Ä—Å–∏–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π sitemap (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)
        with open(sitemap_file, 'r', encoding='utf-8') as f:
            content = f.read()
            # –ò–∑–≤–ª–µ–∫–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ URL (–∫—Ä–æ–º–µ –±–ª–æ–≥-–ø–æ—Å—Ç–æ–≤)
            import re
            urls = re.findall(r'<loc>(https://www\.tabatatimer\.ru/[^<]+)</loc>', content)
            for url in urls:
                if '/blog/' not in url:  # –ò—Å–∫–ª—é—á–∞–µ–º —Å—Ç–∞—Ä—ã–µ –±–ª–æ–≥-–ø–æ—Å—Ç—ã
                    sitemap_entries.append(url)
    
    # –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –±–ª–æ–≥, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    if 'https://www.tabatatimer.ru/' not in sitemap_entries:
        sitemap_entries.insert(0, 'https://www.tabatatimer.ru/')
    if 'https://www.tabatatimer.ru/blog.html' not in sitemap_entries:
        sitemap_entries.append('https://www.tabatatimer.ru/blog.html')
    
    # –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –ø–æ—Å—Ç—ã –±–ª–æ–≥–∞
    for –ø–æ—Å—Ç in –ø–æ—Å—Ç—ã:
        post_id = –ø–æ—Å—Ç.get('id', 'unknown')
        –∑–∞–≥–æ–ª–æ–≤–æ–∫ = –ø–æ—Å—Ç.get('title', '–°—Ç–∞—Ç—å—è')
        slug = —Å–æ–∑–¥–∞—Ç—å_slug(–∑–∞–≥–æ–ª–æ–≤–æ–∫, post_id)
        url = f"https://www.tabatatimer.ru/blog/{slug}.html"
        if url not in sitemap_entries:
            sitemap_entries.append(url)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º sitemap.xml
    sitemap_xml = '''<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        xmlns:news="http://www.google.com/schemas/sitemap-news/0.9"
        xmlns:xhtml="http://www.w3.org/1999/xhtml"
        xmlns:image="http://www.google.com/schemas/sitemap-image/1.1"
        xmlns:video="http://www.google.com/schemas/sitemap-video/1.1">
'''
    
    for url in sitemap_entries:
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏ —á–∞—Å—Ç–æ—Ç—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        if url == 'https://www.tabatatimer.ru/':
            priority = '1.0'
            changefreq = 'daily'
        elif '/blog/' in url:
            priority = '0.8'
            changefreq = 'weekly'
        else:
            priority = '0.7'
            changefreq = 'monthly'
        
        sitemap_xml += f'''   <url>
      <loc>{url}</loc>
      <changefreq>{changefreq}</changefreq>
      <priority>{priority}</priority>
   </url>
'''
    
    sitemap_xml += '</urlset>'
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º sitemap
    with open(sitemap_file, 'w', encoding='utf-8') as f:
        f.write(sitemap_xml)
    
    print(f"‚úÖ Sitemap –æ–±–Ω–æ–≤–ª—ë–Ω ({len(sitemap_entries)} URL)")

def —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_—Å—Ç—Ä–∞–Ω–∏—Ü—ã_–¥–ª—è_–≤—Å–µ—Ö_–ø–æ—Å—Ç–æ–≤():
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤ –≤ blog-posts.json"""
    if not BLOG_POSTS_FILE.exists():
        print("‚ùå –§–∞–π–ª blog-posts.json –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    with open(BLOG_POSTS_FILE, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    –ø–æ—Å—Ç—ã = data.get('posts', [])
    print(f"üìù –ù–∞–π–¥–µ–Ω–æ –ø–æ—Å—Ç–æ–≤: {len(–ø–æ—Å—Ç—ã)}")
    
    —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ = 0
    for –ø–æ—Å—Ç in –ø–æ—Å—Ç—ã:
        try:
            html, slug = —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_html_—Å—Ç—Ä–∞–Ω–∏—Ü—É(–ø–æ—Å—Ç)
            —Ñ–∞–π–ª = BLOG_POSTS_DIR / f"{slug}.html"
            
            with open(—Ñ–∞–π–ª, 'w', encoding='utf-8') as f:
                f.write(html)
            
            —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ += 1
            print(f"‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞: {slug}.html")
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø–æ—Å—Ç–∞ {–ø–æ—Å—Ç.get('id', 'unknown')}: {e}")
    
    print(f"\n‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å—Ç—Ä–∞–Ω–∏—Ü: {—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ}/{len(–ø–æ—Å—Ç—ã)}")
    
    # –û–±–Ω–æ–≤–ª—è–µ–º sitemap
    –æ–±–Ω–æ–≤–∏—Ç—å_sitemap()

if __name__ == '__main__':
    —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_—Å—Ç—Ä–∞–Ω–∏—Ü—ã_–¥–ª—è_–≤—Å–µ—Ö_–ø–æ—Å—Ç–æ–≤()
