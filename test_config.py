#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
"""

import os
from pathlib import Path

# –°–ø–∏—Å–æ–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
REQUIRED_VARS = {
    'TELEGRAM_BOT_TOKEN': '–¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞',
    'TELEGRAM_CHAT_ID': 'ID Telegram –∫–∞–Ω–∞–ª–∞',
    'DEEPSEEK_API_KEY': 'API –∫–ª—é—á DeepSeek',
    'ADMIN_TELEGRAM_CHAT_ID': 'ID –ª–∏—á–Ω–æ–≥–æ Telegram –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤',
    'SMTP_SERVER': 'SMTP —Å–µ—Ä–≤–µ—Ä –¥–ª—è email',
    'SMTP_PORT': '–ü–æ—Ä—Ç SMTP',
    'SMTP_USER': 'Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
    'SMTP_PASSWORD': '–ü–∞—Ä–æ–ª—å SMTP'
}

# –°–ø–∏—Å–æ–∫ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
OPTIONAL_VARS = {
    # –ú–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –±—É–¥—É—â–µ–º
}

def –ø—Ä–æ–≤–µ—Ä–∫–∞_–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è"""
    print("üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...\n")
    
    –≤—Å–µ_–æ–∫ = True
    –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ = []
    –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ = []
    
    for var_name, –æ–ø–∏—Å–∞–Ω–∏–µ in REQUIRED_VARS.items():
        –∑–Ω–∞—á–µ–Ω–∏–µ = os.getenv(var_name)
        if –∑–Ω–∞—á–µ–Ω–∏–µ:
            –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ.append(var_name)
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ/–ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            if len(–∑–Ω–∞—á–µ–Ω–∏–µ) > 10:
                –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ = –∑–Ω–∞—á–µ–Ω–∏–µ[:4] + "..." + –∑–Ω–∞—á–µ–Ω–∏–µ[-4:]
            else:
                –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ = "***"
            print(f"‚úÖ {var_name}: {–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ} ({–æ–ø–∏—Å–∞–Ω–∏–µ})")
        else:
            –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ.append(var_name)
            print(f"‚ùå {var_name}: –û–¢–°–£–¢–°–¢–í–£–ï–¢ ({–æ–ø–∏—Å–∞–Ω–∏–µ})")
            –≤—Å–µ_–æ–∫ = False
    
    print("\n" + "="*60)
    
    if –≤—Å–µ_–æ–∫:
        print("‚úÖ –í–°–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ù–ê–°–¢–†–û–ï–ù–´!")
        print(f"   –ù–∞–π–¥–µ–Ω–æ: {len(–ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ)}/{len(REQUIRED_VARS)}")
    else:
        print("‚ùå –û–¢–°–£–¢–°–¢–í–£–Æ–¢ –ü–ï–†–ï–ú–ï–ù–ù–´–ï:")
        for var in –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ:
            print(f"   - {var}")
    
    return –≤—Å–µ_–æ–∫

def –ø—Ä–æ–≤–µ—Ä–∫–∞_—Ñ–∞–π–ª–æ–≤():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤"""
    print("\nüìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤...\n")
    
    —Ñ–∞–π–ª—ã = {
        'auto_reply.py': '–û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç–æ–≤',
        'statistics.py': '–ú–æ–¥—É–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏',
        '.github/workflows/auto-reply.yml': 'Workflow –¥–ª—è GitHub Actions'
    }
    
    –≤—Å–µ_–æ–∫ = True
    
    for —Ñ–∞–π–ª, –æ–ø–∏—Å–∞–Ω–∏–µ in —Ñ–∞–π–ª—ã.items():
        –ø—É—Ç—å = Path(—Ñ–∞–π–ª)
        if –ø—É—Ç—å.exists():
            —Ä–∞–∑–º–µ—Ä = –ø—É—Ç—å.stat().st_size
            print(f"‚úÖ {—Ñ–∞–π–ª} ({—Ä–∞–∑–º–µ—Ä} –±–∞–π—Ç) - {–æ–ø–∏—Å–∞–Ω–∏–µ}")
        else:
            print(f"‚ùå {—Ñ–∞–π–ª} - –ù–ï –ù–ê–ô–î–ï–ù ({–æ–ø–∏—Å–∞–Ω–∏–µ})")
            –≤—Å–µ_–æ–∫ = False
    
    return –≤—Å–µ_–æ–∫

def –ø—Ä–æ–≤–µ—Ä–∫–∞_–∏–º–ø–æ—Ä—Ç–æ–≤():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π"""
    print("\nüì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤...\n")
    
    –≤—Å–µ_–æ–∫ = True
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
    —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ = ['os', 'json', 'requests', 'smtplib', 'email']
    for –º–æ–¥—É–ª—å in —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ:
        try:
            __import__(–º–æ–¥—É–ª—å)
            print(f"‚úÖ {–º–æ–¥—É–ª—å} - –¥–æ—Å—Ç—É–ø–µ–Ω")
        except ImportError as e:
            print(f"‚ùå {–º–æ–¥—É–ª—å} - –û–®–ò–ë–ö–ê: {e}")
            –≤—Å–µ_–æ–∫ = False
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ statistics.py
    try:
        from pathlib import Path
        stats_path = Path('statistics.py')
        if stats_path.exists():
            print("‚úÖ statistics.py - —Ñ–∞–π–ª –Ω–∞–π–¥–µ–Ω")
        else:
            print("‚ùå statistics.py - —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω")
            –≤—Å–µ_–æ–∫ = False
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ statistics.py: {e}")
        –≤—Å–µ_–æ–∫ = False
    
    return –≤—Å–µ_–æ–∫

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("="*60)
    print("üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò")
    print("="*60)
    
    —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã = {
        '–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ': –ø—Ä–æ–≤–µ—Ä–∫–∞_–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö(),
        '—Ñ–∞–π–ª—ã': –ø—Ä–æ–≤–µ—Ä–∫–∞_—Ñ–∞–π–ª–æ–≤(),
        '–∏–º–ø–æ—Ä—Ç—ã': –ø—Ä–æ–≤–µ—Ä–∫–∞_–∏–º–ø–æ—Ä—Ç–æ–≤()
    }
    
    print("\n" + "="*60)
    print("üìä –ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:")
    print("="*60)
    
    –≤—Å–µ_–æ–∫ = all(—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.values())
    
    for –ø—Ä–æ–≤–µ—Ä–∫–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç in —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.items():
        —Å—Ç–∞—Ç—É—Å = "‚úÖ" if —Ä–µ–∑—É–ª—å—Ç–∞—Ç else "‚ùå"
        print(f"{—Å—Ç–∞—Ç—É—Å} {–ø—Ä–æ–≤–µ—Ä–∫–∞.upper()}")
    
    print("\n" + "="*60)
    
    if –≤—Å–µ_–æ–∫:
        print("üéâ –í–°–Å –ì–û–¢–û–í–û –ö –†–ê–ë–û–¢–ï!")
        print("\n–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ó–∞–ø—É—Å—Ç–∏—Ç–µ workflow –≤ GitHub Actions")
        return 0
    else:
        print("‚ö†Ô∏è –ï–°–¢–¨ –ü–†–û–ë–õ–ï–ú–´ - –ò–°–ü–†–ê–í–¨–¢–ï –ü–ï–†–ï–î –ó–ê–ü–£–°–ö–û–ú")
        return 1

if __name__ == "__main__":
    exit(main())

